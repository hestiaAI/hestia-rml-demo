"use strict";(("undefined"!=typeof self?self:this).webpackChunkdata_experience=("undefined"!=typeof self?self:this).webpackChunkdata_experience||[]).push([[3288,3632,1297],{93288:function(t,e,r){r.r(e),r.d(e,{default:function(){return d}});var n=r(21297),i=r(99319),o=r(53632),l=r(82768),c=r(96963),u={components:{ChartViewTopRow:o.default,UnitKepler:l.Z,UnitFilterableTable:c.Z},mixins:[n.default],props:{keplerConfig:{type:Object,default:()=>null}},data:()=>({filteredRows:[]}),computed:{total(){return this.values.length},get_name_transport(){const t=this.values.map((t=>({name_of_transport:t.transitPath.substr(0,t.transitPath.indexOf(":")),k:t.k})));return(0,i.a)(t,["name_of_transport"],[])},header_name_transport(){return Object.keys(this.get_name_transport[0])},get_trips(){const t=this.values.map((t=>({...t,start_end:t.transitPath.substr(t.transitPath.indexOf(":")+1)})));return(0,i.a)(t,["start_end"],["startLatitude","startLongitude","endLatitude","endLongitude"])},header_trips(){return Object.keys(this.get_trips[0])},keplerData(){return{fields:this.header_trips.map((t=>({name:t}))),rows:this.get_trips.map((t=>this.header_trips.map((e=>t[e]))))}},keplerArgs(){return{keplerData:this.keplerData,config:this.keplerConfig}}},methods:{onTableFilter(t){this.filteredRows=t}}},h=u,p=(0,r(1001).Z)(h,(function(){var t=this,e=t._self._c;return t.values.length>0?e("VContainer",[e("VRow",[e("VCol",{attrs:{cols:"12"}},[0===t.total?e("p",{staticClass:"text-subtitle-2"},[t._v(" "+t._s(t.$t("no-records"))+" ")]):e("p",{staticClass:"text-subtitle-2"},[t._v(" This shows the public tansportation that was used by at least k participants: ")])])],1),t.total>0?[e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("ChartViewTopRow",t._b({attrs:{"y-accessor":"name_of_transport","x-accessor":"k","x-label":"k","count-label":"public tansportation that was used by at least k participants","y-label":"transport line"}},"ChartViewTopRow",{headers:t.header_name_transport,values:t.get_name_transport},!1))],1)],1),e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("p",[t._v(" This map shows the trips made in public transport by at least k participants: ")]),e("UnitKepler",{attrs:{args:t.keplerArgs}})],1)],1),e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("UnitFilterableTable",t._b({on:{"current-items":t.onTableFilter}},"UnitFilterableTable",{headers:t.header_trips,items:t.get_trips},!1))],1)],1)]:t._e()],2):t._e()}),[],!1,null,null,null),d=p.exports},53632:function(t,e,r){r.r(e),r.d(e,{default:function(){return h}});var n=r(46228),i=r(60171),o={mixins:[r(21297).default],props:{yAccessor:{type:String,required:!0},xAccessor:{type:String,default:""},dateAccessor:{type:String,default:""},yAxisMaxTickLength:{type:Number,default:20},margin:{type:Number,default:5},adjVertical:{type:Array,default:()=>[5,50]},adjHorizontal:{type:Array,default:()=>[150,150]},countLabel:{type:String,default:"records"},xLabel:{type:String,default:"records"},yLabel:{type:String,default:"companies"},dateFormat:{type:String,default:""}},data:()=>({total:0,minDate:null,maxDate:null,records:[],topKSlider:null,othersCheck:!1}),computed:{validProps(){let t=!0;return this.values.length?(this.dateAccessor&&!Object.keys(this.values[0]).includes(this.dateAccessor)&&(console.error("Date Accessor not found"),t=!1),Object.keys(this.values[0]).includes(this.yAccessor)||(console.error("Y Accessor not found"),t=!1),this.xAccessor&&!Object.keys(this.values[0]).includes(this.xAccessor)&&(console.error("X Accessor not found"),t=!1),t):(console.error("Values is empty"),t=!1,t)}},methods:{k:t=>`chart-view.top-row.${t}`,draw(){const t=this.records.slice(0,this.othersCheck?this.topKSlider-1:this.topKSlider);this.othersCheck&&(t.push({key:"Others",value:n.Smz(this.records.slice(this.topKSlider),(t=>t.value))}),t.sort((function(t,e){return n.$1i(t.value,e.value)}))),this.xScale.domain(n.Wem(t,(t=>t.value))),this.yScale.domain(t.map((function(t){return t.key})));const e=this.svg.selectAll(".bars").data(t,(t=>t.key)),r=this;e.enter().append("rect").attr("class","bars").attr("x",5).attr("y",(t=>this.yScale(t.key))).attr("width",0).attr("height",this.yScale.bandwidth()).attr("fill","#69b3a2").on("mouseover",(function(t,e){n.Ys(this).style("opacity",.7),n.Ys(this.parentNode).append("text").attr("class","barsLabel").text(e.value).attr("text-anchor","start").attr("alignment-baseline","middle").attr("x",r.xScale(e.value)+15).attr("y",r.yScale(e.key)+r.yScale.bandwidth()/2).style("font-size","0.8rem").style("font-weight","bold").style("fill","#0A0A0A")})).on("mouseleave",(function(t,e){n.Ys(this).style("opacity",1),n.Ys(".barsLabel").remove()})).merge(e).transition().duration(1e3).delay(200).attr("y",(t=>this.yScale(t.key))).attr("width",(t=>this.xScale(t.value)+5)).attr("height",this.yScale.bandwidth()),e.exit().transition().duration(1e3).attr("width",0).remove(),n.Ys(".yAxis").transition().duration(1e3).delay(200).call(this.yAxis),n.td_(".yAxis g text").transition().duration(1e3).delay(200).style("font-size",1.8/Math.log(this.topKSlider)+"rem"),n.Ys(".xAxis").transition().duration(1e3).delay(200).call(this.xAxis)},drawViz(){if(!this.validProps)return;const t=this.dateFormat?n.Z1g(this.dateFormat):t=>new Date(t),e=t=>this.$d(t,"dateOnly",this.$i18n.locale);if(this.dateAccessor){const[r,s]=n.Wem(this.values,(e=>t(e[this.dateAccessor])));if(!r||!s)throw new Error("Unable to parse date fields");this.minDate=e(r),this.maxDate=e(s)}this.total=this.xAccessor?n.Smz(this.values,(t=>t[this.xAccessor])):this.values.length,this.topKSlider=Math.min(20,this.total),this.records=(0,i.b1)().key((t=>t[this.yAccessor])).rollup((t=>n.Smz(t,(t=>this.xAccessor?t[this.xAccessor]:1)))).entries(this.values).sort((function(t,e){return n.$1i(t.value,e.value)}));n.Ys("#"+this.graphId+" svg").remove(),this.svg=n.Ys("#"+this.graphId).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.adjHorizontal[0]+" -"+this.adjVertical[0]+" "+(300+n.Smz(this.adjHorizontal))+" "+(380+n.Smz(this.adjVertical))).style("padding",this.padding).style("margin",this.margin).classed("svg-content",!0),this.xScale=n.BYU().range([0,300]),this.yScale=n.tiA().range([0,380]).paddingInner(.1);const r=n.y4O(this.yScale).tickFormat((t=>function(t,e){return t.length>e?t.slice(0,e)+"..":t}(t,this.yAxisMaxTickLength))).tickSizeOuter(0),o=n.LLu(this.xScale).ticks(4);this.xAxis=o,this.yAxis=r,this.svg.append("g").attr("class","xAxis").attr("transform","translate(0,380)").call(o).append("text").attr("dy",".75em").attr("y",30).attr("x",150).style("text-anchor","middle").text(this.xLabel),this.svg.append("g").attr("class","yAxis").call(r),this.draw()}}},l=o,c=(0,r(1001).Z)(l,(function(){var t=this,e=t._self._c;return t.validProps?e("VContainer",[e("VRow",{attrs:{dense:""}},[e("VCol",{staticClass:"text-center",attrs:{cols:"12",md:"12"}},[e("i18n",{attrs:{tag:"p",path:t.k("heading")},scopedSlots:t._u([{key:"total",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.total)}})]},proxy:!0},{key:"countLabel",fn:function(){return[t._v(" "+t._s(t.countLabel)+" ")]},proxy:!0},{key:"minDate",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.minDate)}})]},proxy:!0},{key:"maxDate",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.maxDate)}})]},proxy:!0}],null,!1,923081494)})],1)],1),e("VRow",{attrs:{justify:"center",dense:""}},[e("VCol",{staticStyle:{position:"relative"},attrs:{cols:"12",md:"7"}},[e("VMenu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function({on:r,attrs:s}){return[e("VBtn",t._g(t._b({staticStyle:{position:"absolute",right:"0","z-index":"10"},attrs:{icon:""}},"VBtn",s,!1),r),[e("VIcon",{attrs:{small:""}},[t._v(" $vuetify.icons.mdiCog ")])],1)]}}],null,!1,2520745846)},[e("VCard",{staticStyle:{width:"300px"}},[e("VCardTitle",[t._v(t._s(t.$t("Settings")))]),e("VDivider"),e("VCardText",[e("VRow",{staticClass:"mt-3"},[e("VCol",[e("VSlider",{attrs:{label:`NÂ° ${t.$t("of")} ${t.yLabel}`,"thumb-color":"primary","thumb-label":"always",min:"1",max:Math.min(t.total,50),"hide-details":"",dense:""},on:{change:t.draw},model:{value:t.topKSlider,callback:function(e){t.topKSlider=e},expression:"topKSlider"}})],1)],1),e("VRow",[e("VCol",[e("VCheckbox",{attrs:{dense:"",label:t.$t("Display Others"),"hide-details":""},on:{change:t.draw},model:{value:t.othersCheck,callback:function(e){t.othersCheck=e},expression:"othersCheck"}})],1)],1)],1)],1)],1),e("div",{staticStyle:{position:"relative"},attrs:{id:t.graphId}})],1)],1)],1):t._e()}),[],!1,null,"20abbd90",null),h=c.exports},60171:function(t,e,r){r.d(e,{XP:function(){return f},b1:function(){return o}});var s="$";function a(){}function n(t,e){var r=new a;if(t instanceof a)t.each((function(t,e){r.set(e,t)}));else if(Array.isArray(t)){var s,n=-1,i=t.length;if(null==e)for(;++n<i;)r.set(n,t[n]);else for(;++n<i;)r.set(e(s=t[n],n,t),s)}else if(t)for(var o in t)r.set(o,t[o]);return r}a.prototype=n.prototype={constructor:a,has:function(t){return s+t in this},get:function(t){return this[s+t]},set:function(t,e){return this[s+t]=e,this},remove:function(t){var e=s+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===s&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===s&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===s&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===s&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===s&&++t;return t},empty:function(){for(var t in this)if(t[0]===s)return!1;return!0},each:function(t){for(var e in this)e[0]===s&&t(this[e],e.slice(1),this)}};var i=n;function o(){var t,e,r,s=[],a=[];function n(r,a,o,l){if(a>=s.length)return null!=t&&r.sort(t),null!=e?e(r):r;for(var c,u,h,d=-1,p=r.length,f=s[a++],y=i(),m=o();++d<p;)(h=y.get(c=f(u=r[d])+""))?h.push(u):y.set(c,[u]);return y.each((function(t,e){l(m,e,n(t,a,o,l))})),m}function o(t,r){if(++r>s.length)return t;var n,i=a[r-1];return null!=e&&r>=s.length?n=t.entries():(n=[],t.each((function(t,e){n.push({key:e,values:o(t,r)})}))),null!=i?n.sort((function(t,e){return i(t.key,e.key)})):n}return r={object:function(t){return n(t,0,l,c)},map:function(t){return n(t,0,u,h)},entries:function(t){return o(n(t,0,u,h),0)},key:function(t){return s.push(t),r},sortKeys:function(t){return a[s.length-1]=t,r},sortValues:function(e){return t=e,r},rollup:function(t){return e=t,r}}}function l(){return{}}function c(t,e,r){t[e]=r}function u(){return i()}function h(t,e,r){t.set(e,r)}function d(){}var p=i.prototype;function f(t){var e=[];for(var r in t)e.push(r);return e}d.prototype=function(t,e){var r=new d;if(t instanceof d)t.each((function(t){r.add(t)}));else if(t){var s=-1,a=t.length;if(null==e)for(;++s<a;)r.add(t[s]);else for(;++s<a;)r.add(e(t[s],s,t))}return r}.prototype={constructor:d,has:p.has,add:function(t){return this[s+(t+="")]=t,this},remove:p.remove,clear:p.clear,values:p.keys,size:p.size,empty:p.empty,each:p.each}},21297:function(t,e,r){r.r(e);var s=r(40290),a=r(18651),n=r(659);const i={props:{values:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[]},messages:{type:Object,default:()=>({})}},data(){return{graphId:"graph_"+this.$store.state.xp.currentTab,totalCount:0,filterCount:0}},mounted(){this.drawViz()},watch:{values(){this.drawViz()}},methods:{drawViz(){},createTextFilterWidget(t,e="Search"){const r=new s.TextFilterWidget(t);return r.placeHolder(this.$tev(e,e)),r}}};e.default=(0,a.Z)(i,n.Z)},99319:function(t,e,r){r.d(e,{a:function(){return o}});var s=r(15643);function a(t){let e=0;for(let r=1;r<=Math.max.apply(Math,t);r++){if(t.filter((t=>t<=r)).length>=r){e=r;break}}return e}function n(t){return t.reduce(((t,e)=>t+e),0)/t.length||0}function i(t,e){return t.filter((t=>t.k<=e))}function o(t,e,r){const o=[],l=(0,s.Z)(t,(t=>e.map((e=>t[e])))),c=Object.keys(l);for(let s=0;s<c.length;s++){const t=c[s],u={},h=t.split(",");for(let t=0;t<e.length;t++)u[e[t]]=h[t];const d=a(l[t].map((t=>t.k))),p=i(l[t],d);for(let t=0;t<r.length;t++)u[r[t]]=n(p.map((e=>e[r[t]])));u.k=d,o.push(u)}const u=o.filter((t=>t.k>0));return u}}}]);