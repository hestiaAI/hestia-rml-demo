{"version":3,"file":"DataExperience.umd.min.1262.js","mappings":"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","sources":["webpack://DataExperience/./src/components/chart/view/ChartViewGroupBar.vue?d9b5","webpack://DataExperience/src/components/chart/view/ChartViewGroupBar.vue","webpack://DataExperience/./src/components/chart/view/ChartViewGroupBar.vue?5ce8","webpack://DataExperience/./src/components/chart/view/ChartViewGroupBar.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.validProps)?_c('VContainer',[_c('p',{staticClass:\"overline font-weight-bold text-subtitle-1 text-center\"},[_vm._v(\" \"+_vm._s(_vm.title)+\" \")]),_c('div',{staticStyle:{\"position\":\"relative\"},attrs:{\"id\":_vm.graphId}})]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <VContainer v-if=\"validProps\">\n    <p class=\"overline font-weight-bold text-subtitle-1 text-center\">\n      {{ title }}\n    </p>\n    <div :id=\"graphId\" style=\"position: relative\" />\n  </VContainer>\n</template>\n\n<script>\nimport * as d3 from 'd3'\nimport mixin from './mixin'\n\nexport default {\n  mixins: [mixin],\n  props: {\n    groupsAccessor: {\n      type: String,\n      required: true\n    },\n    valuesAccessor: {\n      type: Array,\n      required: true\n    },\n    title: {\n      type: String,\n      default: ''\n    },\n    margin: {\n      type: Number,\n      default: 5\n    },\n    adjVertical: {\n      type: Array,\n      default: () => [20, 50]\n    },\n    adjHorizontal: {\n      type: Array,\n      default: () => [150, 150]\n    },\n    xLabel: {\n      type: String,\n      default: 'Sexual Orientation'\n    },\n    yLabel: {\n      type: String,\n      default: 'Number of action per day and user'\n    },\n    formatNumber: {\n      type: String,\n      default: '.2f'\n    }\n  },\n  data() {\n    return {}\n  },\n  computed: {\n    validProps() {\n      let valid = true\n      if (!this.values.length) {\n        console.error('Values is empty')\n        return false\n      }\n      if (!Object.keys(this.values[0]).includes(this.groupsAccessor)) {\n        console.error('Group Accessor not found:', this.groupsAccessor)\n        valid = false\n      }\n\n      this.valuesAccessor.forEach((accessor) => {\n        if (!Object.keys(this.values[0]).includes(accessor)\n        ) {\n          console.error('X Accessor not found:', accessor)\n          valid = false\n        }\n      })\n      return valid\n    }\n  },\n  methods: {\n    drawViz() {\n      try {\n      /* create svg element */\n        const width = 500\n        const height = 380\n        const formatNumber = d3.format(this.formatNumber)\n        d3.select('#' + this.graphId + ' svg').remove()\n        this.svg = d3\n          .select('#' + this.graphId)\n          .append('svg')\n          .attr('preserveAspectRatio', 'xMinYMin meet')\n          .attr(\n            'viewBox',\n            '-' +\n            this.adjHorizontal[0] +\n            ' -' +\n            this.adjVertical[0] +\n            ' ' +\n            (width + d3.sum(this.adjHorizontal)) +\n            ' ' +\n            (height + d3.sum(this.adjVertical))\n          )\n          .style('margin', this.margin)\n          .classed('svg-content', true)\n\n        // List of unique groups\n        const groups = [...new Set(this.values.map(d => d[this.groupsAccessor]))]\n\n        // Add X axis\n        const x = d3.scaleBand().domain(groups).range([0, width]).padding([0.2])\n        this.svg\n          .append('g')\n          .attr('class', 'xAxis')\n          .attr('transform', 'translate(0,' + height + ')')\n          .call(d3.axisBottom(x).tickSize(0))\n          .append('text')\n          .attr('y', 30)\n          .attr('x', width / 2)\n          .style('text-anchor', 'middle')\n          .text(this.xLabel)\n\n        // Add Y axis\n        const max = d3.max(this.values, d => Math.max(...this.valuesAccessor.map(c => d[c])))\n        const y = d3.scaleLinear().domain([0, max]).range([height, 0])\n        this.svg\n          .append('g')\n          .attr('class', 'yAxis')\n          .call(d3.axisLeft(y))\n          .append('text')\n          .attr('dy', '.75em')\n          .attr('y', -50)\n          .attr('x', -height / 2)\n          .attr('transform', 'rotate(-90)')\n          .style('text-anchor', 'middle')\n          .text(this.yLabel)\n\n        // Another scale for subgroup position?\n        const xSubgroup = d3\n          .scaleBand()\n          .domain(this.valuesAccessor)\n          .range([0, x.bandwidth()])\n          .padding([0.05])\n\n        // color palette = one color per subgroup\n        const color = d3\n          .scaleOrdinal()\n          .domain(this.valuesAccessor)\n          .range(this.colorPalette)\n\n        // Show the bars\n        this.svg\n          .append('g')\n          .selectAll('g')\n        // Enter in data = loop group per group\n          .data(this.values)\n          .enter()\n          .append('g')\n          .attr('transform', d => 'translate(' + x(d[this.groupsAccessor]) + ',0)')\n          .selectAll('rect')\n          .data(d => this.valuesAccessor.map(function(key) {\n            return { key, value: d[key] }\n          }))\n          .enter()\n          .append('rect')\n          .attr('x', d => xSubgroup(d.key))\n          .attr('y', function(d) {\n            return y(d.value)\n          })\n          .attr('width', xSubgroup.bandwidth())\n          .attr('height', d => height - y(d.value))\n          .attr('fill', d => color(d.key))\n          .on('mouseover', function(evt, d) {\n            d3.select(this).style('opacity', 0.7)\n            d3.select(this.parentNode)\n              .append('text')\n              .attr('class', 'barsLabel')\n              .text(formatNumber(d.value))\n              .attr('text-anchor', 'middle')\n              .attr('alignment-baseline', 'middle')\n              .attr('x', xSubgroup(d.key) + xSubgroup.bandwidth() / 2)\n              .attr('y', y(d.value) - 10)\n              .style('font-size', '0.8rem')\n              .style('font-weight', 'bold')\n              .style('fill', '#0A0A0A')\n          })\n          .on('mouseleave', function(evt, d) {\n            d3.select(this).style('opacity', 1)\n            d3.select('.barsLabel').remove()\n          })\n\n        // Add one dot in the legend for each name.\n        const size = 10\n        const positionX = width - 20\n        const positionY = 0\n        this.svg.selectAll('legendSquare')\n          .data(this.valuesAccessor)\n          .enter()\n          .append('rect')\n          .attr('x', positionX)\n          .attr('y', function(d, i) { return positionY + i * (size + 5) })\n          .attr('width', size)\n          .attr('height', size)\n          .style('fill', function(d) { return color(d) })\n\n        // Add one label in the legend for each square\n        this.svg.selectAll('legendLabels')\n          .data(this.valuesAccessor)\n          .enter()\n          .append('text')\n          .attr('x', positionX + size * 1.2)\n          .attr('y', function(d, i) { return positionY + i * (size + 5) + (size / 2) })\n          .style('fill', function(d) { return color(d) })\n          .text(function(d) { return d })\n          .attr('text-anchor', 'left')\n          .style('alignment-baseline', 'middle')\n      } catch (e) {\n        console.error(e)\n      }\n    }\n\n  }\n}\n</script>\n<style scoped>\n/* AXES */\n/* ticks */\n::v-deep .xAxis line,\n::v-deep .yAxis line {\n  stroke: #706f6f;\n  stroke-width: 0.5;\n  shape-rendering: geometricPrecision;\n}\n\n/* axis contour */\n::v-deep .xAxis path,\n::v-deep .yAxis path {\n  stroke: #706f6f;\n  stroke-width: 0.7;\n  shape-rendering: geometricPrecision;\n}\n\n::v-deep .yAxis path {\n  display: none;\n}\n\n/* axis text */\n::v-deep .xAxis text,\n::v-deep .yAxis text {\n  fill: #2b2929;\n  font-weight: 300;\n}\n</style>\n","import mod from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGroupBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGroupBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChartViewGroupBar.vue?vue&type=template&id=558adf62&scoped=true&\"\nimport script from \"./ChartViewGroupBar.vue?vue&type=script&lang=js&\"\nexport * from \"./ChartViewGroupBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChartViewGroupBar.vue?vue&type=style&index=0&id=558adf62&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"558adf62\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","title","staticStyle","attrs","graphId","_e","staticRenderFns","mixins","mixin","props","groupsAccessor","type","String","required","valuesAccessor","Array","default","margin","Number","adjVertical","adjHorizontal","xLabel","yLabel","formatNumber","data","computed","validProps","valid","values","length","Object","keys","includes","console","error","forEach","accessor","methods","drawViz","width","height","remove","svg","append","attr","style","classed","groups","Set","map","d","x","domain","range","padding","call","tickSize","text","max","Math","c","y","xSubgroup","bandwidth","color","colorPalette","selectAll","enter","key","value","on","evt","parentNode","size","positionX","positionY","i","e","component"],"sourceRoot":""}