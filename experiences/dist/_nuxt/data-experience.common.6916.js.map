{"version":3,"file":"data-experience.common.6916.js","mappings":";;;;;;;;;;;;;;;AAAA,+BAA+B,6BAA6B,sEAAsE,OAAO,aAAa,4BAA4B,8BAA8B,6EAA6E,8BAA8B,8MAA8M,OAAO,aAAa,mBAAmB,OAAO,uBAAuB,gDAAgD,OAAO,+DAA+D,sBAAsB,8BAA8B,WAAW,EAAE,iCAAiC,0BAA0B,iCAAiC,iFAAiF,8BAA8B,0CAA0C,aAAa,oBAAoB,cAAc,6BAA6B,mBAAmB,6FAA6F,0BAA0B,2BAA2B,aAAa,wBAAwB,aAAa,kDAAkD,uCAAuC,aAAa,gDAAgD,gEAAgE,OAAO,oEAAoE,sBAAsB,4BAA4B,oBAAoB,IAAI,uBAAuB,yCAAyC,YAAY,EAAE,2BAA2B,oBAAoB,IAAI,uBAAuB,wCAAwC,YAAY,+BAA+B,iDAAiD,oBAAoB,2BAA2B,kDAAkD,IAAI,mBAAmB,uDAAuD,OAAO,kBAAkB,KAAK,sBAAsB,uFAAuF,OAAO,aAAa,mCAAmC,IAAI,mCAAmC,yBAAyB,0CAA0C;AAC/3E;AACA;;;;;;;;;;;;;AC8F2B;AAC0B;AACI;AACmC;;AAE5F,gFAAe;AACf,0BAA0B,gDAAqB;AAC/C,WAAW,gBAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,sCAAgB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;ACxMoJ,CAAC,qFAAe,2CAAG,EAAC;;;;ACAvE;AAC3B;AACL;;;AAGlE;AACA,CAAyG;AACzG,gBAAgB,sCAAU;AAC1B,EAAE,gDAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,wDAAe;;;;;;;;;;;;AClBsB;AACJ;;AAEkB;;AAEnD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,wBAAwB;AACxB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB;AACjB;AACA,yBAAyB,gDAAgB;AACzC;AACA;AACA;AACA;AACA;;AAEA,+DAAe,8DAAK,QAAQ,qEAAe,CAAC;;;;;;;;;;;;AC7CT;;AAEnC;AACA;AACA,kBAAkB,gCAAgC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEO;AACP;AACA,kBAAkB,8DAAO;AACzB;AACA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue?e159","webpack://data-experience/src/components/chart/view/ChartViewGenericMap.vue","webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue?64c3","webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue","webpack://data-experience/./src/components/chart/view/mixin.js","webpack://data-experience/./src/utils/kAnonymity.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.values.length > 0)?_c('VContainer',[_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[(_vm.total === 0)?_c('p',{staticClass:\"text-subtitle-2\"},[_vm._v(\" \"+_vm._s(_vm.$t('no-records'))+\" \")]):(_vm.label_ !== '')?_c('p',{staticClass:\"text-subtitle-2\"},[_vm._v(\" \"+_vm._s(_vm.$t('found'))+\" \"),_c('strong',[_vm._v(_vm._s(_vm.total))]),_vm._v(\" \"+_vm._s(_vm.label_)+\" \"+_vm._s(_vm.$t('in-files'))+\". \")]):_vm._e()])],1),(_vm.total > 0)?[_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[_c('UnitKepler',{attrs:{\"args\":_vm.keplerArgs}})],1)],1),(_vm.showButton == true)?[_c('VMenu',{attrs:{\"close-on-content-click\":false,\"nudge-width\":200,\"offset-y\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('VBtn',_vm._g(_vm._b({staticClass:\"ma-2\",attrs:{\"color\":\"primary\",\"outlined\":\"\"}},'VBtn',attrs,false),on),[_vm._v(\" \"+_vm._s(_vm.$t(_vm.k('add-noise')))+\" \")])]}}],null,false,13010733),model:{value:(_vm.menu),callback:function ($$v) {_vm.menu=$$v},expression:\"menu\"}},[_c('VCard',{staticClass:\"mx-auto\",attrs:{\"max-width\":\"600\"}},[_c('VCardTitle',[_vm._v(_vm._s(_vm.$t(_vm.k('noise-level'))))]),_c('VCardText',[_c('VRow',{staticClass:\"mb-4\",attrs:{\"justify\":\"space-between\"}},[_c('VCol',{staticClass:\"text-left\"},[_c('span',{staticClass:\"text-h2 font-weight-light\",domProps:{\"textContent\":_vm._s(_vm.sliderValue)}}),_c('span',{staticClass:\"subheading font-weight-light mr-1\"},[_vm._v(_vm._s(_vm.$t(_vm.k('meters'))))])])],1),_c('VSlider',{attrs:{\"max\":100,\"min\":0,\"step\":'1',\"track-color\":\"grey\",\"always-dirty\":\"\"},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('VIcon',{on:{\"click\":_vm.decrement}},[_vm._v(\" $vuetify.icons.mdiMinus \")])]},proxy:true},{key:\"append\",fn:function(){return [_c('VIcon',{on:{\"click\":_vm.increment}},[_vm._v(\" $vuetify.icons.mdiPlus \")])]},proxy:true}],null,false,214408879),model:{value:(_vm.sliderValue),callback:function ($$v) {_vm.sliderValue=$$v},expression:\"sliderValue\"}})],1),_c('VCardActions',[_c('VSpacer'),_c('VBtn',{on:{\"click\":_vm.clear}},[_vm._v(\" \"+_vm._s(_vm.$t('Clear'))+\" \")]),_c('VBtn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.addNoise}},[_vm._v(\" \"+_vm._s(_vm.$t('Save'))+\" \")])],1)],1)],1)]:_vm._e(),_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[_c('UnitFilterableTable',_vm._b({on:{\"current-items\":_vm.onTableFilter}},'UnitFilterableTable',{ headers: _vm.headers, items: _vm.results },false))],1)],1)]:_vm._e()],2):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <VContainer v-if=\"values.length > 0\">\n    <VRow>\n      <VCol cols=\"12\">\n        <p v-if=\"total === 0\" class=\"text-subtitle-2\">\n          {{ $t('no-records') }}\n        </p>\n        <p v-else-if=\"label_ !== ''\" class=\"text-subtitle-2\">\n          {{ $t('found') }} <strong>{{ total }}</strong> {{ label_ }} {{ $t('in-files') }}.\n        </p>\n      </VCol>\n    </VRow>\n    <template v-if=\"total > 0\">\n      <VRow>\n        <VCol cols=\"12\">\n          <UnitKepler :args=\"keplerArgs\" />\n        </VCol>\n      </VRow>\n      <template v-if=\"showButton == true\">\n        <VMenu\n          v-model=\"menu\"\n          :close-on-content-click=\"false\"\n          :nudge-width=\"200\"\n          offset-y\n        >\n          <template #activator=\"{ on, attrs }\">\n            <VBtn\n              color=\"primary\"\n              class=\"ma-2\"\n              outlined\n              v-bind=\"attrs\"\n              v-on=\"on\"\n            >\n              {{ $t(k('add-noise')) }}\n            </VBtn>\n          </template>\n          <VCard class=\"mx-auto\" max-width=\"600\">\n            <VCardTitle>{{ $t(k('noise-level')) }}</VCardTitle>\n            <VCardText>\n              <VRow class=\"mb-4\" justify=\"space-between\">\n                <VCol class=\"text-left\">\n                  <span\n                    class=\"text-h2 font-weight-light\"\n                    v-text=\"sliderValue\"\n                  />\n                  <span class=\"subheading font-weight-light mr-1\">{{ $t(k('meters')) }}</span>\n                </VCol>\n              </VRow>\n\n              <VSlider\n                v-model=\"sliderValue\"\n                :max=\"100\"\n                :min=\"0\"\n                :step=\"'1'\"\n                track-color=\"grey\"\n                always-dirty\n              >\n                <template #prepend>\n                  <VIcon @click=\"decrement\">\n                    $vuetify.icons.mdiMinus\n                  </VIcon>\n                </template>\n\n                <template #append>\n                  <VIcon @click=\"increment\">\n                    $vuetify.icons.mdiPlus\n                  </VIcon>\n                </template>\n              </VSlider>\n            </VCardText>\n            <VCardActions>\n              <VSpacer />\n\n              <VBtn @click=\"clear\">\n                {{ $t('Clear') }}\n              </VBtn>\n              <VBtn color=\"primary\" @click=\"addNoise\">\n                {{ $t('Save') }}\n              </VBtn>\n            </VCardActions>\n          </VCard>\n        </VMenu>\n      </template>\n      <VRow>\n        <VCol cols=\"12\">\n          <UnitFilterableTable\n            v-bind=\"{ headers, items: results }\"\n            @current-items=\"onTableFilter\"\n          />\n        </VCol>\n      </VRow>\n    </template>\n  </VContainer>\n</template>\n\n<script>\nimport mixin from './mixin'\nimport { kAnonymityFilter } from '@/utils/kAnonymity'\nimport UnitKepler from '@/components/unit/UnitKepler.vue'\nimport UnitFilterableTable from '@/components/unit/filterable-table/UnitFilterableTable.vue'\n\nexport default {\n  components: { UnitKepler, UnitFilterableTable },\n  mixins: [mixin],\n  props: {\n    keplerConfig: {\n      type: Object,\n      default: () => null\n    },\n    showButton: {\n      type: Boolean,\n      default: () => false\n    },\n    doKAnonymity: {\n      type: Boolean,\n      default: () => false\n    },\n    groupKey: {\n      type: Array,\n      default: () => []\n    },\n    otherKeys: {\n      type: Array,\n      default: () => []\n    },\n    label: {\n      type: String,\n      default: () => ''\n    }\n  },\n  data() {\n    return {\n      menu: false,\n      sliderValue: 0,\n      filteredRows: [],\n      results: this.doKAnonymity\n        ? kAnonymityFilter(this.values, this.groupKey, this.otherKeys)\n        : this.values,\n      label_: this.label\n    }\n  },\n  computed: {\n    total() {\n      return this.results.length\n    },\n    filtered() {\n      return this.filteredRows.length\n    },\n    keplerData() {\n      return {\n        fields: this.headers.map((h) => {\n          return {\n            name: h\n          }\n        }),\n        rows: this.filteredRows.map(r => this.headers.map(h => r[h]))\n      }\n    },\n    keplerArgs() {\n      return {\n        keplerData: this.keplerData,\n        config: this.keplerConfig\n      }\n    }\n  },\n  methods: {\n    k(key) {\n      return `chart-view.generic-map.${key}`\n    },\n    increment() {\n      this.sliderValue += 1\n    },\n    decrement() {\n      this.sliderValue -= 1\n    },\n    addNoise() {\n      this.menu = false\n      const level = this.sliderValue\n      this.results = this.results.map((x) => {\n        return {\n          ...x,\n          longitude: x.longitude +\n                        ((0.5 - Math.random()) /\n                            ((40075 * 10 ** 3 * Math.cos(Math.radians(x.latitude))) / 360)) *\n                            2 *\n                            level,\n          latitude: x.latitude +\n                        ((0.5 - Math.random()) / (111.32 * 10 ** 3)) * 2 * level\n        }\n      })\n    },\n    clear() {\n      this.menu = false\n      this.results = this.values\n      this.sliderValue = 0\n    },\n    onTableFilter(newItems) {\n      this.filteredRows = newItems\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGenericMap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGenericMap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChartViewGenericMap.vue?vue&type=template&id=5ce45d5d&\"\nimport script from \"./ChartViewGenericMap.vue?vue&type=script&lang=js&\"\nexport * from \"./ChartViewGenericMap.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { TextFilterWidget } from 'dc'\nimport { merge } from 'lodash-es'\n\nimport kViewBlockMixin from '@/mixins/k-view-block'\n\nconst mixin = {\n  props: {\n    values: {\n      type: Array,\n      default: () => []\n    },\n    headers: {\n      type: Array,\n      default: () => []\n    },\n    messages: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  data() {\n    return {\n      graphId: 'graph_' + this._uid,\n      totalCount: 0,\n      filterCount: 0\n    }\n  },\n  mounted() {\n    this.drawViz()\n  },\n  watch: {\n    values() {\n      this.drawViz()\n    }\n  },\n  methods: {\n    drawViz() { },\n    createTextFilterWidget(parent, placeholder = 'Search') {\n      const widget = new TextFilterWidget(parent)\n      widget.placeHolder(this.$tev(placeholder, placeholder))\n      return widget\n    }\n  }\n}\n\nexport default merge(mixin, kViewBlockMixin)\n","import { groupBy } from 'lodash-es'\n\nfunction findK(arr) {\n  let kMin = 0\n  for (let j = 1; j <= Math.max.apply(Math, arr); j++) {\n    const l = arr.filter(x => x <= j)\n    if (l.length >= j) {\n      kMin = j\n      break\n    }\n  }\n  return kMin\n}\n\nfunction avg(arr) {\n  const sum = arr.reduce((a, b) => a + b, 0)\n  return sum / arr.length || 0\n}\n\nfunction filterOut(arr, k) {\n  return arr.filter(x => x.k <= k)\n}\n\nexport function kAnonymityFilter(values, groupKeys, otherKeys) {\n  const table = []\n  const grouped = groupBy(values, n => groupKeys.map(x => n[x]))\n  const keys = Object.keys(grouped)\n  for (let i = 0; i < keys.length; i++) {\n    const x = keys[i]\n    const elem = {}\n    const splitted = x.split(',')\n    for (let j = 0; j < groupKeys.length; j++) {\n      elem[groupKeys[j]] = splitted[j]\n    }\n    const kMin = findK(grouped[x].map(v => v.k))\n    const rest = filterOut(grouped[x], kMin)\n    for (let j = 0; j < otherKeys.length; j++) {\n      elem[otherKeys[j]] = avg(rest.map(x => x[otherKeys[j]]))\n    }\n    elem.k = kMin\n    table.push(elem)\n  }\n  const res = table.filter(x => x.k > 0)\n  return res\n}\n"],"names":[],"sourceRoot":""}