{"version":3,"file":"data-experience.umd.6916.js","mappings":";;;;;;;;;;;;;;;AAAA,+BAA+B,6BAA6B,sEAAsE,OAAO,aAAa,4BAA4B,8BAA8B,6EAA6E,8BAA8B,8MAA8M,OAAO,aAAa,mBAAmB,OAAO,uBAAuB,gDAAgD,OAAO,+DAA+D,sBAAsB,8BAA8B,WAAW,EAAE,iCAAiC,0BAA0B,iCAAiC,iFAAiF,8BAA8B,0CAA0C,aAAa,oBAAoB,cAAc,6BAA6B,mBAAmB,6FAA6F,0BAA0B,2BAA2B,aAAa,wBAAwB,aAAa,kDAAkD,uCAAuC,aAAa,gDAAgD,gEAAgE,OAAO,oEAAoE,sBAAsB,4BAA4B,oBAAoB,IAAI,uBAAuB,yCAAyC,YAAY,EAAE,2BAA2B,oBAAoB,IAAI,uBAAuB,wCAAwC,YAAY,+BAA+B,iDAAiD,oBAAoB,2BAA2B,kDAAkD,IAAI,mBAAmB,uDAAuD,OAAO,kBAAkB,KAAK,sBAAsB,uFAAuF,OAAO,aAAa,mCAAmC,IAAI,mCAAmC,yBAAyB,0CAA0C;AAC/3E;AACA;;;;;;;;;;;;;AC8F2B;AAC0B;AACI;AACmC;;AAE5F,gFAAe;AACf,0BAA0B,gDAAqB;AAC/C,WAAW,gBAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,sCAAgB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;ACxMoJ,CAAC,qFAAe,2CAAG,EAAC;;;;ACAvE;AAC3B;AACL;;;AAGlE;AACA,CAAyG;AACzG,gBAAgB,sCAAU;AAC1B,EAAE,gDAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,wDAAe;;;;;;;;;;;;AClBsB;AACJ;AACjC;AACmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,wBAAwB;AACxB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,iBAAiB;AACjB;AACA,yBAAyB,gDAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,+DAAe,8DAAK,QAAQ,qEAAe,CAAC;;;;;;;;;;;;AC7CT;AACnC;AACA;AACA;AACA,kBAAkB,gCAAgC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,kBAAkB,8DAAO;AACzB;AACA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue?e159","webpack://data-experience/src/components/chart/view/ChartViewGenericMap.vue","webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue?64c3","webpack://data-experience/./src/components/chart/view/ChartViewGenericMap.vue","webpack://data-experience/./src/components/chart/view/mixin.js","webpack://data-experience/./src/utils/kAnonymity.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.values.length > 0)?_c('VContainer',[_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[(_vm.total === 0)?_c('p',{staticClass:\"text-subtitle-2\"},[_vm._v(\" \"+_vm._s(_vm.$t('no-records'))+\" \")]):(_vm.label_ !== '')?_c('p',{staticClass:\"text-subtitle-2\"},[_vm._v(\" \"+_vm._s(_vm.$t('found'))+\" \"),_c('strong',[_vm._v(_vm._s(_vm.total))]),_vm._v(\" \"+_vm._s(_vm.label_)+\" \"+_vm._s(_vm.$t('in-files'))+\". \")]):_vm._e()])],1),(_vm.total > 0)?[_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[_c('UnitKepler',{attrs:{\"args\":_vm.keplerArgs}})],1)],1),(_vm.showButton == true)?[_c('VMenu',{attrs:{\"close-on-content-click\":false,\"nudge-width\":200,\"offset-y\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function({ on, attrs }){return [_c('VBtn',_vm._g(_vm._b({staticClass:\"ma-2\",attrs:{\"color\":\"primary\",\"outlined\":\"\"}},'VBtn',attrs,false),on),[_vm._v(\" \"+_vm._s(_vm.$t(_vm.k('add-noise')))+\" \")])]}}],null,false,13010733),model:{value:(_vm.menu),callback:function ($$v) {_vm.menu=$$v},expression:\"menu\"}},[_c('VCard',{staticClass:\"mx-auto\",attrs:{\"max-width\":\"600\"}},[_c('VCardTitle',[_vm._v(_vm._s(_vm.$t(_vm.k('noise-level'))))]),_c('VCardText',[_c('VRow',{staticClass:\"mb-4\",attrs:{\"justify\":\"space-between\"}},[_c('VCol',{staticClass:\"text-left\"},[_c('span',{staticClass:\"text-h2 font-weight-light\",domProps:{\"textContent\":_vm._s(_vm.sliderValue)}}),_c('span',{staticClass:\"subheading font-weight-light mr-1\"},[_vm._v(_vm._s(_vm.$t(_vm.k('meters'))))])])],1),_c('VSlider',{attrs:{\"max\":100,\"min\":0,\"step\":'1',\"track-color\":\"grey\",\"always-dirty\":\"\"},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('VIcon',{on:{\"click\":_vm.decrement}},[_vm._v(\" $vuetify.icons.mdiMinus \")])]},proxy:true},{key:\"append\",fn:function(){return [_c('VIcon',{on:{\"click\":_vm.increment}},[_vm._v(\" $vuetify.icons.mdiPlus \")])]},proxy:true}],null,false,214408879),model:{value:(_vm.sliderValue),callback:function ($$v) {_vm.sliderValue=$$v},expression:\"sliderValue\"}})],1),_c('VCardActions',[_c('VSpacer'),_c('VBtn',{on:{\"click\":_vm.clear}},[_vm._v(\" \"+_vm._s(_vm.$t('Clear'))+\" \")]),_c('VBtn',{attrs:{\"color\":\"primary\"},on:{\"click\":_vm.addNoise}},[_vm._v(\" \"+_vm._s(_vm.$t('Save'))+\" \")])],1)],1)],1)]:_vm._e(),_c('VRow',[_c('VCol',{attrs:{\"cols\":\"12\"}},[_c('UnitFilterableTable',_vm._b({on:{\"current-items\":_vm.onTableFilter}},'UnitFilterableTable',{ headers: _vm.headers, items: _vm.results },false))],1)],1)]:_vm._e()],2):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <VContainer v-if=\"values.length > 0\">\r\n    <VRow>\r\n      <VCol cols=\"12\">\r\n        <p v-if=\"total === 0\" class=\"text-subtitle-2\">\r\n          {{ $t('no-records') }}\r\n        </p>\r\n        <p v-else-if=\"label_ !== ''\" class=\"text-subtitle-2\">\r\n          {{ $t('found') }} <strong>{{ total }}</strong> {{ label_ }} {{ $t('in-files') }}.\r\n        </p>\r\n      </VCol>\r\n    </VRow>\r\n    <template v-if=\"total > 0\">\r\n      <VRow>\r\n        <VCol cols=\"12\">\r\n          <UnitKepler :args=\"keplerArgs\" />\r\n        </VCol>\r\n      </VRow>\r\n      <template v-if=\"showButton == true\">\r\n        <VMenu\r\n          v-model=\"menu\"\r\n          :close-on-content-click=\"false\"\r\n          :nudge-width=\"200\"\r\n          offset-y\r\n        >\r\n          <template #activator=\"{ on, attrs }\">\r\n            <VBtn\r\n              color=\"primary\"\r\n              class=\"ma-2\"\r\n              outlined\r\n              v-bind=\"attrs\"\r\n              v-on=\"on\"\r\n            >\r\n              {{ $t(k('add-noise')) }}\r\n            </VBtn>\r\n          </template>\r\n          <VCard class=\"mx-auto\" max-width=\"600\">\r\n            <VCardTitle>{{ $t(k('noise-level')) }}</VCardTitle>\r\n            <VCardText>\r\n              <VRow class=\"mb-4\" justify=\"space-between\">\r\n                <VCol class=\"text-left\">\r\n                  <span\r\n                    class=\"text-h2 font-weight-light\"\r\n                    v-text=\"sliderValue\"\r\n                  />\r\n                  <span class=\"subheading font-weight-light mr-1\">{{ $t(k('meters')) }}</span>\r\n                </VCol>\r\n              </VRow>\r\n\r\n              <VSlider\r\n                v-model=\"sliderValue\"\r\n                :max=\"100\"\r\n                :min=\"0\"\r\n                :step=\"'1'\"\r\n                track-color=\"grey\"\r\n                always-dirty\r\n              >\r\n                <template #prepend>\r\n                  <VIcon @click=\"decrement\">\r\n                    $vuetify.icons.mdiMinus\r\n                  </VIcon>\r\n                </template>\r\n\r\n                <template #append>\r\n                  <VIcon @click=\"increment\">\r\n                    $vuetify.icons.mdiPlus\r\n                  </VIcon>\r\n                </template>\r\n              </VSlider>\r\n            </VCardText>\r\n            <VCardActions>\r\n              <VSpacer />\r\n\r\n              <VBtn @click=\"clear\">\r\n                {{ $t('Clear') }}\r\n              </VBtn>\r\n              <VBtn color=\"primary\" @click=\"addNoise\">\r\n                {{ $t('Save') }}\r\n              </VBtn>\r\n            </VCardActions>\r\n          </VCard>\r\n        </VMenu>\r\n      </template>\r\n      <VRow>\r\n        <VCol cols=\"12\">\r\n          <UnitFilterableTable\r\n            v-bind=\"{ headers, items: results }\"\r\n            @current-items=\"onTableFilter\"\r\n          />\r\n        </VCol>\r\n      </VRow>\r\n    </template>\r\n  </VContainer>\r\n</template>\r\n\r\n<script>\r\nimport mixin from './mixin'\r\nimport { kAnonymityFilter } from '@/utils/kAnonymity'\r\nimport UnitKepler from '@/components/unit/UnitKepler.vue'\r\nimport UnitFilterableTable from '@/components/unit/filterable-table/UnitFilterableTable.vue'\r\n\r\nexport default {\r\n  components: { UnitKepler, UnitFilterableTable },\r\n  mixins: [mixin],\r\n  props: {\r\n    keplerConfig: {\r\n      type: Object,\r\n      default: () => null\r\n    },\r\n    showButton: {\r\n      type: Boolean,\r\n      default: () => false\r\n    },\r\n    doKAnonymity: {\r\n      type: Boolean,\r\n      default: () => false\r\n    },\r\n    groupKey: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    otherKeys: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    label: {\r\n      type: String,\r\n      default: () => ''\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      menu: false,\r\n      sliderValue: 0,\r\n      filteredRows: [],\r\n      results: this.doKAnonymity\r\n        ? kAnonymityFilter(this.values, this.groupKey, this.otherKeys)\r\n        : this.values,\r\n      label_: this.label\r\n    }\r\n  },\r\n  computed: {\r\n    total() {\r\n      return this.results.length\r\n    },\r\n    filtered() {\r\n      return this.filteredRows.length\r\n    },\r\n    keplerData() {\r\n      return {\r\n        fields: this.headers.map((h) => {\r\n          return {\r\n            name: h\r\n          }\r\n        }),\r\n        rows: this.filteredRows.map(r => this.headers.map(h => r[h]))\r\n      }\r\n    },\r\n    keplerArgs() {\r\n      return {\r\n        keplerData: this.keplerData,\r\n        config: this.keplerConfig\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    k(key) {\r\n      return `chart-view.generic-map.${key}`\r\n    },\r\n    increment() {\r\n      this.sliderValue += 1\r\n    },\r\n    decrement() {\r\n      this.sliderValue -= 1\r\n    },\r\n    addNoise() {\r\n      this.menu = false\r\n      const level = this.sliderValue\r\n      this.results = this.results.map((x) => {\r\n        return {\r\n          ...x,\r\n          longitude: x.longitude +\r\n                        ((0.5 - Math.random()) /\r\n                            ((40075 * 10 ** 3 * Math.cos(Math.radians(x.latitude))) / 360)) *\r\n                            2 *\r\n                            level,\r\n          latitude: x.latitude +\r\n                        ((0.5 - Math.random()) / (111.32 * 10 ** 3)) * 2 * level\r\n        }\r\n      })\r\n    },\r\n    clear() {\r\n      this.menu = false\r\n      this.results = this.values\r\n      this.sliderValue = 0\r\n    },\r\n    onTableFilter(newItems) {\r\n      this.filteredRows = newItems\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGenericMap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChartViewGenericMap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChartViewGenericMap.vue?vue&type=template&id=5ce45d5d&\"\nimport script from \"./ChartViewGenericMap.vue?vue&type=script&lang=js&\"\nexport * from \"./ChartViewGenericMap.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { TextFilterWidget } from 'dc'\r\nimport { merge } from 'lodash-es'\r\n\r\nimport kViewBlockMixin from '@/mixins/k-view-block'\r\n\r\nconst mixin = {\r\n  props: {\r\n    values: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    headers: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    messages: {\r\n      type: Object,\r\n      default: () => ({})\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      graphId: 'graph_' + this.$store.state.xp.currentTab,\r\n      totalCount: 0,\r\n      filterCount: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    this.drawViz()\r\n  },\r\n  watch: {\r\n    values() {\r\n      this.drawViz()\r\n    }\r\n  },\r\n  methods: {\r\n    drawViz() { },\r\n    createTextFilterWidget(parent, placeholder = 'Search') {\r\n      const widget = new TextFilterWidget(parent)\r\n      widget.placeHolder(this.$tev(placeholder, placeholder))\r\n      return widget\r\n    }\r\n  }\r\n}\r\n\r\nexport default merge(mixin, kViewBlockMixin)\r\n","import { groupBy } from 'lodash-es'\r\n\r\nfunction findK(arr) {\r\n  let kMin = 0\r\n  for (let j = 1; j <= Math.max.apply(Math, arr); j++) {\r\n    const l = arr.filter(x => x <= j)\r\n    if (l.length >= j) {\r\n      kMin = j\r\n      break\r\n    }\r\n  }\r\n  return kMin\r\n}\r\n\r\nfunction avg(arr) {\r\n  const sum = arr.reduce((a, b) => a + b, 0)\r\n  return sum / arr.length || 0\r\n}\r\n\r\nfunction filterOut(arr, k) {\r\n  return arr.filter(x => x.k <= k)\r\n}\r\n\r\nexport function kAnonymityFilter(values, groupKeys, otherKeys) {\r\n  const table = []\r\n  const grouped = groupBy(values, n => groupKeys.map(x => n[x]))\r\n  const keys = Object.keys(grouped)\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const x = keys[i]\r\n    const elem = {}\r\n    const splitted = x.split(',')\r\n    for (let j = 0; j < groupKeys.length; j++) {\r\n      elem[groupKeys[j]] = splitted[j]\r\n    }\r\n    const kMin = findK(grouped[x].map(v => v.k))\r\n    const rest = filterOut(grouped[x], kMin)\r\n    for (let j = 0; j < otherKeys.length; j++) {\r\n      elem[otherKeys[j]] = avg(rest.map(x => x[otherKeys[j]]))\r\n    }\r\n    elem.k = kMin\r\n    table.push(elem)\r\n  }\r\n  const res = table.filter(x => x.k > 0)\r\n  return res\r\n}\r\n"],"names":[],"sourceRoot":""}