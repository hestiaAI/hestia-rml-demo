{"version":3,"file":"DataExperience.common.9299.js","mappings":";;;;;;;;;;;;;;;AAAA,+BAA+B,6BAA6B,+BAA+B,aAAa,gEAAgE,EAAE,gCAAgC,aAAa,8EAA8E,EAAE,qDAAqD,wBAAwB,aAAa,YAAY,KAAK,iCAAiC,EAAE,oCAAoC,yBAAyB,wCAAwC;AAC1hB;AACA;;;;;;;;;;;;;;;ACe0C;AACf;AACe;AACsB;AACgB;;AAEhF,uFAAe;AACf;AACA,0BAA0B,gDAAqB;AAC/C,WAAW,oBAAK,EAAE,4BAAY;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,sCAAY;AAC1C;AACA,gEAAgE,sCAAY;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AC7E8J,CAAC,8FAAe,kDAAG,EAAC;;;;ACA1E;AAC3B;AACL;;;AAGzE;AACA,CAA4G;AAC5G,gBAAgB,sCAAU;AAC1B,EAAE,yDAAM;AACR,EAAE,MAAM;AACR,EAAE,eAAe;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,+DAAe","sources":["webpack://@hestia.ai/data-experience/./src/components/unit/file-explorer/viewer/UnitFileExplorerViewerXlsx.vue?d532","webpack://@hestia.ai/data-experience/src/components/unit/file-explorer/viewer/UnitFileExplorerViewerXlsx.vue","webpack://@hestia.ai/data-experience/./src/components/unit/file-explorer/viewer/UnitFileExplorerViewerXlsx.vue?a234","webpack://@hestia.ai/data-experience/./src/components/unit/file-explorer/viewer/UnitFileExplorerViewerXlsx.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.loading)?_c('div',{directives:[{name:\"t\",rawName:\"v-t\",value:('Loading'),expression:\"'Loading'\"}]}):(_vm.error)?_c('div',[_c('p',{directives:[{name:\"t\",rawName:\"v-t\",value:(_vm.k('errorText')),expression:\"k('errorText')\"}]})]):_c('div',[_vm._l((_vm.sheets),function(_,name,i){return _c('BaseButton',{key:i,attrs:{\"text\":name},on:{\"click\":v => _vm.setSheet(name)}})}),_c('UnitFilterableTable',_vm._b({},'UnitFilterableTable',{ headers: _vm.headers, items: _vm.items },false))],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-if=\"loading\" v-t=\"'Loading'\" />\n  <div v-else-if=\"error\">\n    <p v-t=\"k('errorText')\" />\n  </div>\n  <div v-else>\n    <BaseButton\n      v-for=\"(_, name, i) in sheets\"\n      :key=\"i\"\n      :text=\"name\"\n      @click=\"v => setSheet(name)\"\n    />\n    <UnitFilterableTable v-bind=\"{ headers, items }\" />\n  </div>\n</template>\n\n<script>\nimport readXlsxFile from 'read-excel-file'\nimport mixin from './mixin'\nimport mixinLoading from './mixin-loading'\nimport BaseButton from '@/components/base/button/BaseButton.vue'\nimport UnitFilterableTable from '../../filterable-table/UnitFilterableTable.vue'\n\nexport default {\n  name: 'UnitFileExplorerViewerXlsx',\n  components: { BaseButton, UnitFilterableTable },\n  mixins: [mixin, mixinLoading],\n  data() {\n    return {\n      loading: true,\n      error: false,\n      file: null,\n      sheets: {},\n      headers: [],\n      items: []\n    }\n  },\n  watch: {\n    filename: {\n      async handler(filename) {\n        await this.getContentFromFilename(filename)\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    k(key) {\n      return `file-explorer.viewer.xlsx.${key}`\n    },\n    async getContentFromFilename(filename) {\n      this.setLoading(true)\n      this.file = this.fileManager.fileDict[filename]\n      try {\n        // Get the names of the sheets\n        const sheets = (await readXlsxFile(this.file, { getSheets: true })).map(s => s.name)\n        // Read the content of all sheets\n        const sheetsContent = await Promise.all(sheets.map(s => readXlsxFile(this.file, { sheet: s })))\n        this.sheets = Object.fromEntries(sheetsContent.map((rows, i) => {\n          const headers = Array.from({ length: Math.max(...rows.map(r => r.length)) }, (_, j) => 'Column ' + (j + 1))\n          const items = rows.map((row) => {\n            return Object.fromEntries(headers.map((h, j) => [h, row[j]]))\n          })\n          return [sheets[i], { headers, items }]\n        }))\n        // Set the first sheet as visible\n        this.setSheet(sheets[0])\n        this.error = false\n      } catch (error) {\n        this.error = true\n      }\n      this.setLoading(false)\n    },\n    setSheet(name) {\n      this.headers = this.sheets[name].headers\n      this.items = this.sheets[name].items\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UnitFileExplorerViewerXlsx.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UnitFileExplorerViewerXlsx.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UnitFileExplorerViewerXlsx.vue?vue&type=template&id=90584de0&\"\nimport script from \"./UnitFileExplorerViewerXlsx.vue?vue&type=script&lang=js&\"\nexport * from \"./UnitFileExplorerViewerXlsx.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":[],"sourceRoot":""}