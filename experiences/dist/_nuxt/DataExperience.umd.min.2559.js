"use strict";(("undefined"!=typeof self?self:this).webpackChunkDataExperience=("undefined"!=typeof self?self:this).webpackChunkDataExperience||[]).push([[2559,8468],{12559:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var r=s(74097),i=s(45506),n=s(68468),o=s(23096),l=s(59174),u={components:{ChartViewTopRow:n.default,UnitKepler:o.Z,UnitFilterableTable:l.Z},mixins:[r.default],props:{keplerConfig:{type:Object,default:()=>null}},data:()=>({filteredRows:[]}),computed:{total(){return this.values.length},get_name_transport(){const t=this.values.map((t=>({name_of_transport:t.transitPath.substr(0,t.transitPath.indexOf(":")),k:t.k})));return(0,i.a)(t,["name_of_transport"],[])},header_name_transport(){return Object.keys(this.get_name_transport[0])},get_trips(){const t=this.values.map((t=>({...t,start_end:t.transitPath.substr(t.transitPath.indexOf(":")+1)})));return(0,i.a)(t,["start_end"],["startLatitude","startLongitude","endLatitude","endLongitude"])},header_trips(){return Object.keys(this.get_trips[0])},keplerData(){return{fields:this.header_trips.map((t=>({name:t}))),rows:this.get_trips.map((t=>this.header_trips.map((e=>t[e]))))}},keplerArgs(){return{keplerData:this.keplerData,config:this.keplerConfig}}},methods:{onTableFilter(t){this.filteredRows=t}}},c=u,p=(0,s(1001).Z)(c,(function(){var t=this,e=t._self._c;return t.values.length>0?e("VContainer",[e("VRow",[e("VCol",{attrs:{cols:"12"}},[0===t.total?e("p",{directives:[{name:"t",rawName:"v-t",value:"records-none",expression:"'records-none'"}],staticClass:"text-subtitle-2"}):e("p",{staticClass:"text-subtitle-2"},[t._v(" This shows the public tansportation that was used by at least k participants: ")])])],1),t.total>0?[e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("ChartViewTopRow",t._b({attrs:{"y-accessor":"name_of_transport","x-accessor":"k","x-label":"k","count-label":"public tansportation that was used by at least k participants","y-label":"transport line"}},"ChartViewTopRow",{headers:t.header_name_transport,values:t.get_name_transport},!1))],1)],1),e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("p",[t._v(" This map shows the trips made in public transport by at least k participants: ")]),e("UnitKepler",{attrs:{args:t.keplerArgs}})],1)],1),e("VRow",[e("VCol",{attrs:{cols:"12"}},[e("UnitFilterableTable",t._b({on:{"current-items":t.onTableFilter}},"UnitFilterableTable",{headers:t.header_trips,items:t.get_trips},!1))],1)],1)]:t._e()],2):t._e()}),[],!1,null,null,null),h=p.exports},68468:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var r=s(60194),i=s(60171),n={mixins:[s(74097).default],props:{yAccessor:{type:String,required:!0},xAccessor:{type:String,default:""},dateAccessor:{type:String,default:""},yAxisMaxTickLength:{type:Number,default:20},margin:{type:Number,default:5},adjVertical:{type:Array,default:()=>[5,50]},adjHorizontal:{type:Array,default:()=>[150,150]},countLabel:{type:String,default:"records"},xLabel:{type:String,default:"records"},yLabel:{type:String,default:"companies"},dateFormat:{type:String,default:""}},data:()=>({total:0,minDate:null,maxDate:null,records:[],topKSlider:null,othersCheck:!1}),computed:{validProps(){let t=!0;return this.values.length?(this.dateAccessor&&!Object.keys(this.values[0]).includes(this.dateAccessor)&&(console.error("Date Accessor not found"),t=!1),Object.keys(this.values[0]).includes(this.yAccessor)||(console.error("Y Accessor not found"),t=!1),this.xAccessor&&!Object.keys(this.values[0]).includes(this.xAccessor)&&(console.error("X Accessor not found"),t=!1),t):(console.error("Values is empty"),t=!1,t)}},methods:{k:t=>`chart-view.top-row.${t}`,draw(){const t=this.records.slice(0,this.othersCheck?this.topKSlider-1:this.topKSlider);this.othersCheck&&(t.push({key:"Others",value:r.sum(this.records.slice(this.topKSlider),(t=>t.value))}),t.sort((function(t,e){return r.descending(t.value,e.value)}))),this.xScale.domain(r.extent(t,(t=>t.value))),this.yScale.domain(t.map((function(t){return t.key})));const e=this.svg.selectAll(".bars").data(t,(t=>t.key)),s=this;e.enter().append("rect").attr("class","bars").attr("x",5).attr("y",(t=>this.yScale(t.key))).attr("width",0).attr("height",this.yScale.bandwidth()).attr("fill",this.colorPalette[0]).on("mouseover",(function(t,e){r.select(this).style("opacity",.7),r.select(this.parentNode).append("text").attr("class","barsLabel").text(e.value).attr("text-anchor","start").attr("alignment-baseline","middle").attr("x",s.xScale(e.value)+15).attr("y",s.yScale(e.key)+s.yScale.bandwidth()/2).style("font-size","0.8rem").style("font-weight","bold").style("fill","#0A0A0A")})).on("mouseleave",(function(t,e){r.select(this).style("opacity",1),r.select(".barsLabel").remove()})).merge(e).transition().duration(1e3).delay(200).attr("y",(t=>this.yScale(t.key))).attr("width",(t=>this.xScale(t.value)+5)).attr("height",this.yScale.bandwidth()),e.exit().transition().duration(1e3).attr("width",0).remove(),r.select(".yAxis").transition().duration(1e3).delay(200).call(this.yAxis),r.selectAll(".yAxis g text").transition().duration(1e3).delay(200).style("font-size",1.8/Math.log(this.topKSlider)+"rem"),r.select(".xAxis").transition().duration(1e3).delay(200).call(this.xAxis)},drawViz(){if(!this.validProps)return;const t=this.dateFormat?r.timeParse(this.dateFormat):t=>new Date(t),e=t=>this.$d(t,"dateOnly",this.$i18n.locale);if(this.dateAccessor){const[s,n]=r.extent(this.values,(e=>t(e[this.dateAccessor])));if(!s||!n)throw new Error("Unable to parse date fields");this.minDate=e(s),this.maxDate=e(n)}this.total=this.xAccessor?r.sum(this.values,(t=>t[this.xAccessor])):this.values.length,this.topKSlider=Math.min(20,this.total),this.records=(0,i.b1)().key((t=>t[this.yAccessor])).rollup((t=>r.sum(t,(t=>this.xAccessor?t[this.xAccessor]:1)))).entries(this.values).sort((function(t,e){return r.descending(t.value,e.value)}));r.select("#"+this.graphId+" svg").remove(),this.svg=r.select("#"+this.graphId).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.adjHorizontal[0]+" -"+this.adjVertical[0]+" "+(300+r.sum(this.adjHorizontal))+" "+(380+r.sum(this.adjVertical))).style("padding",this.padding).style("margin",this.margin).classed("svg-content",!0),this.xScale=r.scaleLinear().range([0,300]),this.yScale=r.scaleBand().range([0,380]).paddingInner(.1);const n=r.axisLeft(this.yScale).tickFormat((t=>function(t,e){return t.length>e?t.slice(0,e)+"..":t}(t,this.yAxisMaxTickLength))).tickSizeOuter(0),o=r.axisBottom(this.xScale).ticks(4);this.xAxis=o,this.yAxis=n,this.svg.append("g").attr("class","xAxis").attr("transform","translate(0,380)").call(o).append("text").attr("dy",".75em").attr("y",30).attr("x",150).style("text-anchor","middle").text(this.xLabel),this.svg.append("g").attr("class","yAxis").call(n),this.draw()}}},o=n,l=(0,s(1001).Z)(o,(function(){var t=this,e=t._self._c;return t.validProps?e("VContainer",[e("VRow",{attrs:{dense:""}},[e("VCol",{staticClass:"text-center",attrs:{cols:"12",md:"12"}},[e("i18n",{attrs:{tag:"p",path:t.k("heading")},scopedSlots:t._u([{key:"total",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.total)}})]},proxy:!0},{key:"countLabel",fn:function(){return[t._v(" "+t._s(t.countLabel)+" ")]},proxy:!0},{key:"minDate",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.minDate)}})]},proxy:!0},{key:"maxDate",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.maxDate)}})]},proxy:!0}],null,!1,923081494)})],1)],1),e("VRow",{attrs:{justify:"center",dense:""}},[e("VCol",{staticStyle:{position:"relative"},attrs:{cols:"12",md:"7"}},[e("VMenu",{attrs:{"offset-x":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:r}){return[e("VBtn",t._g(t._b({staticStyle:{position:"absolute",right:"0","z-index":"10"},attrs:{icon:""}},"VBtn",r,!1),s),[e("VIcon",{attrs:{small:""}},[t._v(" $vuetify.icons.mdiCog ")])],1)]}}],null,!1,2520745846)},[e("VCard",{staticStyle:{width:"300px"}},[e("VCardTitle",[t._v(t._s(t.$t("Settings")))]),e("VDivider"),e("VCardText",[e("VRow",{staticClass:"mt-3"},[e("VCol",[e("VSlider",{attrs:{label:`NÂ° ${t.$t("of")} ${t.yLabel}`,"thumb-color":"primary","thumb-label":"always",min:"1",max:Math.min(t.total,50),"hide-details":"",dense:""},on:{change:t.draw},model:{value:t.topKSlider,callback:function(e){t.topKSlider=e},expression:"topKSlider"}})],1)],1),e("VRow",[e("VCol",[e("VCheckbox",{attrs:{dense:"",label:t.$t("Display Others"),"hide-details":""},on:{change:t.draw},model:{value:t.othersCheck,callback:function(e){t.othersCheck=e},expression:"othersCheck"}})],1)],1)],1)],1)],1),e("div",{staticStyle:{position:"relative"},attrs:{id:t.graphId}})],1)],1)],1):t._e()}),[],!1,null,"be13dd44",null),c=l.exports},60171:function(t,e,s){s.d(e,{XP:function(){return f},b1:function(){return o}});var r="$";function a(){}function n(t,e){var s=new a;if(t instanceof a)t.each((function(t,e){s.set(e,t)}));else if(Array.isArray(t)){var r,n=-1,i=t.length;if(null==e)for(;++n<i;)s.set(n,t[n]);else for(;++n<i;)s.set(e(r=t[n],n,t),r)}else if(t)for(var o in t)s.set(o,t[o]);return s}a.prototype=n.prototype={constructor:a,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,e){return this[r+t]=e,this},remove:function(t){var e=r+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===r&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===r&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===r&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var e in this)e[0]===r&&t(this[e],e.slice(1),this)}};var i=n;function o(){var t,e,s,r=[],a=[];function n(s,a,o,l){if(a>=r.length)return null!=t&&s.sort(t),null!=e?e(s):s;for(var c,u,h,d=-1,p=s.length,f=r[a++],y=i(),m=o();++d<p;)(h=y.get(c=f(u=s[d])+""))?h.push(u):y.set(c,[u]);return y.each((function(t,e){l(m,e,n(t,a,o,l))})),m}function o(t,s){if(++s>r.length)return t;var n,i=a[s-1];return null!=e&&s>=r.length?n=t.entries():(n=[],t.each((function(t,e){n.push({key:e,values:o(t,s)})}))),null!=i?n.sort((function(t,e){return i(t.key,e.key)})):n}return s={object:function(t){return n(t,0,l,c)},map:function(t){return n(t,0,u,h)},entries:function(t){return o(n(t,0,u,h),0)},key:function(t){return r.push(t),s},sortKeys:function(t){return a[r.length-1]=t,s},sortValues:function(e){return t=e,s},rollup:function(t){return e=t,s}}}function l(){return{}}function c(t,e,s){t[e]=s}function u(){return i()}function h(t,e,s){t.set(e,s)}function d(){}var p=i.prototype;function f(t){var e=[];for(var s in t)e.push(s);return e}d.prototype=function(t,e){var s=new d;if(t instanceof d)t.each((function(t){s.add(t)}));else if(t){var r=-1,a=t.length;if(null==e)for(;++r<a;)s.add(t[r]);else for(;++r<a;)s.add(e(t[r],r,t))}return s}.prototype={constructor:d,has:p.has,add:function(t){return this[r+(t+="")]=t,this},remove:p.remove,clear:p.clear,values:p.keys,size:p.size,empty:p.empty,each:p.each}}}]);