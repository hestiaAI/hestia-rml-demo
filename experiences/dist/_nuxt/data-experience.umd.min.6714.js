"use strict";(("undefined"!=typeof self?self:this).webpackChunkdata_experience=("undefined"!=typeof self?self:this).webpackChunkdata_experience||[]).push([[6714,8736,1297],{26714:function(t,e,n){n.r(e),n.d(e,{default:function(){return Y}});var i=n(46228),s=n(60171);function a(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let r=-1;for(let o of t)(o=+e(o,++r,t))&&(n+=o)}return n}function u(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let o of t)null!=(o=e(o,++r,t))&&(n<o||void 0===n&&o>=o)&&(n=o)}return n}function r(t,e){return t.sourceLinks.length?t.depth:e-1}function o(t){return function(){return t}}function c(t,e){return p(t.source,e.source)||t.index-e.index}function l(t,e){return p(t.target,e.target)||t.index-e.index}function p(t,e){return t.y0-e.y0}function f(t){return t.value}function g(t){return t.index}function h(t){return t.nodes}function d(t){return t.links}function y(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function v({nodes:t}){for(const e of t){let t=e.y0,n=t;for(const n of e.sourceLinks)n.y0=t+n.width/2,t+=n.width;for(const t of e.targetLinks)t.y1=n+t.width/2,n+=t.width}}function x(){let t,e,n,x=0,k=0,i=1,s=1,_=24,m=8,b=g,w=r,L=h,M=d,B=6;function V(){const t={nodes:L.apply(null,arguments),links:M.apply(null,arguments)};return C(t),S(t),T(t),A(t),N(t),v(t),t}function C({nodes:t,links:e}){for(const[e,n]of t.entries())n.index=e,n.sourceLinks=[],n.targetLinks=[];const r=new Map(t.map(((e,n)=>[b(e,n,t),e])));for(const[t,n]of e.entries()){n.index=t;let{source:e,target:o}=n;"object"!=typeof e&&(e=n.source=y(r,e)),"object"!=typeof o&&(o=n.target=y(r,o)),e.sourceLinks.push(n),o.targetLinks.push(n)}if(null!=n)for(const{sourceLinks:e,targetLinks:i}of t)e.sort(n),i.sort(n)}function S({nodes:t}){for(const e of t)e.value=void 0===e.fixedValue?Math.max(a(e.sourceLinks,f),a(e.targetLinks,f)):e.fixedValue}function T({nodes:t}){const e=t.length;let n=new Set(t),r=new Set,o=0;for(;n.size;){for(const t of n){t.depth=o;for(const{target:e}of t.sourceLinks)r.add(e)}if(++o>e)throw new Error("circular link");n=r,r=new Set}}function A({nodes:t}){const e=t.length;let n=new Set(t),r=new Set,o=0;for(;n.size;){for(const t of n){t.height=o;for(const{source:e}of t.targetLinks)r.add(e)}if(++o>e)throw new Error("circular link");n=r,r=new Set}}function I({nodes:t}){const n=u(t,(t=>t.depth))+1,r=(i-x-_)/(n-1),s=new Array(n);for(const e of t){const t=Math.max(0,Math.min(n-1,Math.floor(w.call(null,e,n))));e.layer=t,e.x0=x+t*r,e.x1=e.x0+_,s[t]?s[t].push(e):s[t]=[e]}if(e)for(const t of s)t.sort(e);return s}function N(e){const n=I(e);t=Math.min(m,(s-k)/(u(n,(t=>t.length))-1)),function(e){const n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let o of t)null!=(o=e(o,++r,t))&&(n>o||void 0===n&&o>=o)&&(n=o)}return n}(e,(e=>(s-k-(e.length-1)*t)/a(e,f)));for(const r of e){let e=k;for(const o of r){o.y0=e,o.y1=e+o.value*n,e=o.y1+t;for(const t of o.sourceLinks)t.width=t.value*n}e=(s-e+t)/(r.length+1);for(let t=0;t<r.length;++t){const n=r[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}Y(r)}}(n);for(let t=0;t<B;++t){const e=Math.pow(.99,t),r=Math.max(1-e,(t+1)/B);$(n,e,r),z(n,e,r)}}function z(t,n,r){for(let o=1,i=t.length;o<i;++o){const i=t[o];for(const t of i){let e=0,r=0;for(const{source:n,value:i}of t.targetLinks){let o=i*(t.layer-n.layer);e+=D(n,t)*o,r+=o}if(!(r>0))continue;let o=(e/r-t.y0)*n;t.y0+=o,t.y1+=o,W(t)}void 0===e&&i.sort(p),E(i,r)}}function $(t,n,r){for(let i=t.length-2;i>=0;--i){const o=t[i];for(const t of o){let e=0,r=0;for(const{target:n,value:i}of t.sourceLinks){let o=i*(n.layer-t.layer);e+=R(t,n)*o,r+=o}if(!(r>0))continue;let o=(e/r-t.y0)*n;t.y0+=o,t.y1+=o,W(t)}void 0===e&&o.sort(p),E(o,r)}}function E(e,n){const r=e.length>>1,i=e[r];Z(e,i.y0-t,r-1,n),P(e,i.y1+t,r+1,n),Z(e,s,e.length-1,n),P(e,k,0,n)}function P(e,n,r,o){for(;r<e.length;++r){const i=e[r],s=(n-i.y0)*o;s>1e-6&&(i.y0+=s,i.y1+=s),n=i.y1+t}}function Z(e,n,r,o){for(;r>=0;--r){const i=e[r],s=(i.y1-n)*o;s>1e-6&&(i.y0-=s,i.y1-=s),n=i.y0-t}}function W({sourceLinks:t,targetLinks:e}){if(void 0===n){for(const{source:{sourceLinks:t}}of e)t.sort(l);for(const{target:{targetLinks:e}}of t)e.sort(c)}}function Y(t){if(void 0===n)for(const{sourceLinks:e,targetLinks:n}of t)e.sort(l),n.sort(c)}function D(e,n){let r=e.y0-(e.sourceLinks.length-1)*t/2;for(const{target:o,width:i}of e.sourceLinks){if(o===n)break;r+=i+t}for(const{source:t,width:o}of n.targetLinks){if(t===e)break;r-=o}return r}function R(e,n){let r=n.y0-(n.targetLinks.length-1)*t/2;for(const{source:o,width:i}of n.targetLinks){if(o===e)break;r+=i+t}for(const{target:t,width:o}of e.sourceLinks){if(t===n)break;r-=o}return r}return V.update=function(t){return v(t),t},V.nodeId=function(t){return arguments.length?(b="function"==typeof t?t:o(t),V):b},V.nodeAlign=function(t){return arguments.length?(w="function"==typeof t?t:o(t),V):w},V.nodeSort=function(t){return arguments.length?(e=t,V):e},V.nodeWidth=function(t){return arguments.length?(_=+t,V):_},V.nodePadding=function(e){return arguments.length?(m=t=+e,V):m},V.nodes=function(t){return arguments.length?(L="function"==typeof t?t:o(t),V):L},V.links=function(t){return arguments.length?(M="function"==typeof t?t:o(t),V):M},V.linkSort=function(t){return arguments.length?(n=t,V):n},V.size=function(t){return arguments.length?(x=k=0,i=+t[0],s=+t[1],V):[i-x,s-k]},V.extent=function(t){return arguments.length?(x=+t[0][0],i=+t[1][0],k=+t[0][1],s=+t[1][1],V):[[x,k],[i,s]]},V.iterations=function(t){return arguments.length?(B=+t,V):B},V}var k=Math.PI,b=2*k,_=1e-6,m=b-_;function w(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function L(){return new w}w.prototype=L.prototype={constructor:w,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,o,i){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(t,e,n,r,o){t=+t,e=+e,n=+n,r=+r,o=+o;var i=this._x1,s=this._y1,a=n-t,u=r-e,c=i-t,l=s-e,f=c*c+l*l;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>_)if(Math.abs(l*a-u*c)>_&&o){var h=n-i,d=r-s,p=a*a+u*u,y=h*h+d*d,g=Math.sqrt(p),v=Math.sqrt(f),x=o*Math.tan((k-Math.acos((p+f-y)/(2*g*v)))/2),m=x/v,w=x/g;Math.abs(m-1)>_&&(this._+="L"+(t+m*c)+","+(e+m*l)),this._+="A"+o+","+o+",0,0,"+ +(l*h>c*d)+","+(this._x1=t+w*a)+","+(this._y1=e+w*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,o,i){t=+t,e=+e,i=!!i;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=t+s,c=e+a,l=1^i,f=i?r-o:o-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>_||Math.abs(this._y1-c)>_)&&(this._+="L"+u+","+c),n&&(f<0&&(f=f%b+b),f>m?this._+="A"+n+","+n+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):f>_&&(this._+="A"+n+","+n+",0,"+ +(f>=k)+","+l+","+(this._x1=t+n*Math.cos(o))+","+(this._y1=e+n*Math.sin(o))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var M=L,B=Array.prototype.slice;function V(t){return function(){return t}}function C(t){return t[0]}function S(t){return t[1]}function T(t){return t.source}function A(t){return t.target}function I(t,e,n,r,o){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,o,r,o)}function N(){return function(t){var e=T,n=A,r=C,o=S,i=null;function s(){var s,a=B.call(arguments),u=e.apply(this,a),c=n.apply(this,a);if(i||(i=s=M()),t(i,+r.apply(this,(a[0]=u,a)),+o.apply(this,a),+r.apply(this,(a[0]=c,a)),+o.apply(this,a)),s)return i=null,s+""||null}return s.source=function(t){return arguments.length?(e=t,s):e},s.target=function(t){return arguments.length?(n=t,s):n},s.x=function(t){return arguments.length?(r="function"==typeof t?t:V(+t),s):r},s.y=function(t){return arguments.length?(o="function"==typeof t?t:V(+t),s):o},s.context=function(t){return arguments.length?(i=null==t?null:t,s):i},s}(I)}function z(t){return[t.source.x1,t.y0]}function $(t){return[t.target.x0,t.y1]}var E=n(21297),P={name:"ChartViewSankey",components:{ChartViewVRowWebShare:n(18736).default},mixins:[E.default],props:{topN:{type:Number,default:10},displayLinksLabels:{type:Boolean,default:!0},nodeWidth:{type:Number,default:40},nodePadding:{type:Number,default:40}},data:()=>({total:0}),methods:{k:t=>`chart-view.sankey.${t}`,toJSONGraph(t){const e=i.uTd(t,(t=>t.length),(t=>t.source),(t=>t.target)).map((t=>({source:t[0],target:t[1],value:t[2]}))).filter((t=>""!==t.source&&""!==t.target&&t.value&&t.source!==t.target)).sort(((t,e)=>i.$1i(+t.value,+e.value))).slice(0,this.topN),n={nodes:[],links:[]};return e.forEach((function(t){t.sourceName=t.source,t.targetName=t.target,t.source=t.source+"s",t.target=t.target+"t",n.nodes.push({id:t.source}),n.nodes.push({id:t.target}),n.links.push({source:t.source,target:t.target,sourceName:t.sourceName,targetName:t.targetName,value:t.value})})),n.nodes=(0,s.XP)((0,s.b1)().key((t=>t.id)).object(n.nodes)),n.links.forEach((function(t,e){n.links[e].source=n.nodes.indexOf(n.links[e].source),n.links[e].target=n.nodes.indexOf(n.links[e].target)})),n.nodes.forEach((function(t,e){n.nodes[e]={name:t}})),n},drawViz(){this.total=this.values.length;const t=this.toJSONGraph(this.values),e=50,n=250,r=10,o=250,c=i.Ys("#"+this.graphId).node().getBoundingClientRect().width-o-n,l=50*this.topN-e-r,f=i.PKp().domain(t.nodes.map((t=>t.name.slice(0,-1)))).range(i.XgA),s=i.Ys("#"+this.graphId).append("div").style("opacity",1).html(`(${this.$t(this.k("hoverMessage"))})`).style("left",c/2+o+"px").style("top","0px"),a=i.Ys("#"+this.graphId).append("svg").attr("width",c+o+n).attr("height",l+e+r).append("g").attr("transform","translate("+o+","+e+")"),u=i.Ys("#"+this.graphId).append("div").style("opacity",0).attr("class","tooltip");a.append("text").attr("class","label").attr("x",0).attr("y",-e/2).text(this.$t(this.kViewBlock("sourceText"))),a.append("text").attr("class","label").attr("x",c).attr("y",-e/2).attr("text-anchor","end").text(this.$t(this.kViewBlock("targetText")));const h=x().nodeWidth(this.nodeWidth).nodePadding(this.nodePadding).size([c,l]);h.links();const d=h(t);a.append("g").selectAll("#"+this.graphId+".link").data(d.links).enter().append("path").attr("class","link").attr("d",N().source(z).target($)).attr("stroke-width",(t=>t.width)).attr("opacity",.2).on("mouseover",((t,e)=>{const n=this.$t(this.kViewBlock("linkMouseoverHTML"),e);s.html(n).style("opacity",1),i.Ys(this).attr("opacity",.7)})).on("mouseleave",(function(t){i.Ys(this).attr("opacity",.2),s.style("opacity",0)}));const y=a.append("g").selectAll("#"+this.graphId+".node").data(d.nodes).enter().append("g").attr("class","node");y.append("rect").attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("height",(t=>t.y1-t.y0)).attr("width",h.nodeWidth()).style("fill",(t=>t.color=f(t.name.slice(0,-1)))).style("stroke",(function(t){return i.B8C(t.color).darker(1)})),y.on("mouseover",((t,e)=>{const n=this.$t(this.kViewBlock("nodeMouseoverHTML"),{name:e.name.slice(0,-1),value:e.value,fromTo:this.$t(this.kViewBlock("s"===e.name.slice(-1)?"from":"to"))}),r=s.node().getBoundingClientRect().height;u.html(n).style("left",e.x1+o+8+"px").style("top",e.y0+r+35+"px"),u.style("opacity",1),i.Ys(this).attr("opacity",.7),i.td_("#"+this.graphId+".link").attr("opacity",.2),a.selectAll("#"+this.graphId+".link").filter((t=>e.index===t.source.index||e.index===t.target.index)).attr("opacity",.7)})).on("mouseleave",(function(t){i.td_("#"+this.graphId+".link").attr("opacity",.2),i.Ys(this).attr("opacity",1),u.style("opacity",0)})),this.displayLinksLabels&&y.append("text").attr("x",(t=>t.x1+6)).attr("y",(t=>(t.y1+t.y0)/2)).attr("dy","0.35em").attr("text-anchor","start").text((t=>{let e=t.name.split(",")[0];return e.length>20&&(e=e.slice(0,20)+".."),e})).filter((t=>t.x0<c/2)).attr("x",(t=>t.x0-6)).attr("text-anchor","end")}}},Z=P,W=(0,n(1001).Z)(Z,(function(){var t=this,e=t._self._c;return e("VContainer",[e("ChartViewVRowWebShare",[e("VCol",{staticClass:"text-center",attrs:{cols:"12",md:"12"}},[e("i18n",{attrs:{path:t.kViewBlock("labelTotal"),tag:"p"},scopedSlots:t._u([{key:"total",fn:function(){return[e("span",{staticClass:"font-weight-bold",domProps:{textContent:t._s(t.total)}})]},proxy:!0}])}),e("div",{staticStyle:{position:"relative"},attrs:{id:t.graphId}})],1)],1)],1)}),[],!1,null,"654c5e13",null),Y=W.exports},18736:function(t,e,n){n.r(e),n.d(e,{default:function(){return c}});var i=n(12555),s=n(4031),a=n(97888),u=n(9934),r={components:{BaseButton:s.Z,BaseButtonDownloadData:a.Z,BaseButtonShare:u.Z},mixins:[(0,i.Z)()]},o=(0,n(1001).Z)(r,(function(){var t=this,e=t._self._c;return e("VRow",t._b({ref:"domToImageNode"},"VRow",t.$attrs,!1),[t._t("default"),e("VCol",{staticClass:"dom-to-image-exclude",attrs:{cols:"12"}},[e("BaseButton",t._b({attrs:{icon:"mdiExport",text:"Export"},on:{click:t.exportImage}},"BaseButton",{progress:t.progress,status:t.status,error:t.error},!1)),e("BaseButtonDownloadData",t._b({},"BaseButtonDownloadData",{disabled:!t.blob,extension:t.extension,filename:t.filename,data:t.blob},!1)),e("BaseButtonShare",t._b({attrs:{"file-share":""}},"BaseButtonShare",{files:t.files,disabled:!t.files},!1))],1)],2)}),[],!1,null,null,null),c=o.exports},60171:function(t,e,n){n.d(e,{XP:function(){return y},b1:function(){return a}});var r="$";function o(){}function i(t,e){var n=new o;if(t instanceof o)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,s=t.length;if(null==e)for(;++i<s;)n.set(i,t[i]);else for(;++i<s;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}o.prototype=i.prototype={constructor:o,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,e){return this[r+t]=e,this},remove:function(t){var e=r+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===r&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===r&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===r&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var e in this)e[0]===r&&t(this[e],e.slice(1),this)}};var s=i;function a(){var t,e,n,r=[],o=[];function i(n,o,a,u){if(o>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var c,l,f,h=-1,d=n.length,p=r[o++],y=s(),g=a();++h<d;)(f=y.get(c=p(l=n[h])+""))?f.push(l):y.set(c,[l]);return y.each((function(t,e){u(g,e,i(t,o,a,u))})),g}function a(t,n){if(++n>r.length)return t;var i,s=o[n-1];return null!=e&&n>=r.length?i=t.entries():(i=[],t.each((function(t,e){i.push({key:e,values:a(t,n)})}))),null!=s?i.sort((function(t,e){return s(t.key,e.key)})):i}return n={object:function(t){return i(t,0,u,c)},map:function(t){return i(t,0,l,f)},entries:function(t){return a(i(t,0,l,f),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return o[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}function u(){return{}}function c(t,e,n){t[e]=n}function l(){return s()}function f(t,e,n){t.set(e,n)}function h(){}var d=s.prototype;function y(t){var e=[];for(var n in t)e.push(n);return e}h.prototype=function(t,e){var n=new h;if(t instanceof h)t.each((function(t){n.add(t)}));else if(t){var r=-1,o=t.length;if(null==e)for(;++r<o;)n.add(t[r]);else for(;++r<o;)n.add(e(t[r],r,t))}return n}.prototype={constructor:h,has:d.has,add:function(t){return this[r+(t+="")]=t,this},remove:d.remove,clear:d.clear,values:d.keys,size:d.size,empty:d.empty,each:d.each}},21297:function(t,e,n){n.r(e);var r=n(40290),o=n(18651),i=n(659);const s={props:{values:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[]},messages:{type:Object,default:()=>({})}},data(){return{graphId:"graph_"+this.$store.state.xp.currentTab,totalCount:0,filterCount:0}},mounted(){this.drawViz()},watch:{values(){this.drawViz()}},methods:{drawViz(){},createTextFilterWidget(t,e="Search"){const n=new r.TextFilterWidget(t);return n.placeHolder(this.$tev(e,e)),n}}};e.default=(0,o.Z)(s,i.Z)}}]);