"use strict";(("undefined"!=typeof self?self:this).webpackChunkdata_experience=("undefined"!=typeof self?self:this).webpackChunkdata_experience||[]).push([[2534,8736,1297,9258],{42534:function(t,e,r){r.r(e),r.d(e,{default:function(){return p}});var n=r(46228),i=r(60171),l=r(19258),o=r(21297),c={components:{ChartViewVRowWebShare:r(18736).default},mixins:[o.default],props:{dateAccessor:{type:Object,required:!0},seriesAccessor:{type:Object,required:!0},valueAccessor:{type:String,default:null},valueFormat:{type:String,default:"~s"},yLabel:{type:String,default:"Count"},filters:{type:Array,default:()=>[]},lineWidth:{type:Number,default:2},dotWidth:{type:Number,default:2},dotRadius:{type:Number,default:4},padding:{type:Number,default:5},margin:{type:Number,default:5},adj:{type:Number,default:70},title:{type:String,default:"Title of the Graph"},legendOffset:{type:Number,default:0},legendPadding:{type:Number,default:10},dateFormat:{type:String,default:""},cumSum:{type:Boolean,default:!1}},data:()=>({slices:[],selectedInterval:null,intervals:{},namesInterval:[],settingDialog:!1,filterItems:{},filterModel:{},extentDate:null,dateParser:t=>new Date(t)}),methods:{initFilters(){this.filters.forEach(((t,e)=>{this.filterItems[t.value]=[],this.filterItems[t.value]=this.values.map((e=>e[t.value])).filter(((t,e,r)=>r.indexOf(t)===e))}))},resetFilters(){this.filters.forEach((t=>{this.filterModel[t.value]=null}))},applyFilters(){this.slices.forEach((t=>{const e=this.intervals[this.selectedInterval],r=Object.keys(this.filterModel).filter((t=>null!=this.filterModel[t]));if(t.current=t.values.filter((t=>r.every((e=>this.filterModel[e]===t[e])))),t.current=(0,i.b1)().key((t=>e.parser(this.dateParser(t.date)))).rollup((t=>n.Smz(t,(t=>t.value)))).entries(t.current),t.current=(0,l.addMissingDate)(t.current,"key","value",e.parser,0,this.extentDate[0],this.extentDate[1]),t.current=t.current.sort(((t,e)=>this.dateParser(t.key)-this.dateParser(e.key))),this.cumSum){const e=n.zbp(t.current,(t=>t.value));t.current=t.current.map(((t,r)=>({...t,value:e[r]})))}}))},drawViz(){this.dateFormat&&(this.dateParser=n.Z1g(this.dateFormat)),this.extentDate=n.Wem(this.values,(t=>this.dateParser(t[this.dateAccessor.value])));const t=n.rr1.count(this.extentDate[0],this.extentDate[1]);if(!t)return void console.error("Unrecognized Dates");t<93&&(this.intervals.Day={parser:n.rr1,format:n.i$Z("%B %d, %Y")}),t>14&&t<651&&(this.intervals.Week={parser:n.NGh,format:n.i$Z("%B %d, %Y")}),t>62&&t<1800&&(this.intervals.Month={parser:n.F0B,format:n.i$Z("%B %Y")}),t>730&&(this.intervals.Year={parser:n.jBk,format:n.i$Z("%Y")}),this.namesInterval=Object.keys(this.intervals).map((t=>({value:t,text:this.$tc(t,2)})));const e=this.values.map((t=>t[this.seriesAccessor.value])).filter(((t,e,r)=>r.indexOf(t)===e));this.slices=e.map((t=>({id:"legend"in this.messages?this.messages.legend[t]:t,values:this.values.filter((e=>t===e[this.seriesAccessor.value])).map((t=>{const e={date:this.dateParser(t[this.dateAccessor.value]),value:this.valueAccessor?+t[this.valueAccessor]:1};return this.filters.forEach((r=>{e[r.value]=t[r.value]})),e})).sort(((t,e)=>t.date-e.date))}))),this.selectedInterval=this.namesInterval.slice(-1)[0].value,this.initFilters(),this.applyFilters(),this.draw()},draw(){const{graphId:t,adj:e}=this;n.Ys(`#${t} svg`).remove();const s=n.Ys(`#${t}`).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`-${e} -${e} ${800+2*e} ${300+2*e}`).style("padding",this.padding).style("margin",this.margin).classed("svg-content",!0);function i(t,e,r){return n.Wem(t.reduce((function(t,a){const s=n.Wem(a[e],r);return t.push(s[0]),t.push(s[1]),t}),[]))}const r=n.Xf().range([0,800]),l=n.BYU().rangeRound([300,0]);r.domain(i(this.slices,"current",(t=>this.dateParser(t.key)))),l.domain([0,i(this.slices,"current",(t=>t.value))[1]]);const u=n.y4O().ticks(5).scale(l),o=n.LLu().ticks(8).scale(r);s.append("g").attr("class","xAxis").attr("transform","translate(0,300)").call(o).selectAll("text").attr("y",0).attr("x",9).attr("dy","2em").attr("transform","rotate(-30)").style("text-anchor","end"),s.append("g").attr("class","yAxis").call(u).append("text").attr("transform","rotate(-90)").attr("dy",".75em").attr("y",-60).style("text-anchor","end").text(this.yLabel),n.td_("#"+t+" g.yAxis g.tick").append("line").attr("class","gridline").attr("x1",0).attr("y1",0).attr("x2",800).attr("y2",0);const c=this.slices.map((t=>t.id)),d=n.PKp().domain(c).range(n.XgA),f=s.selectAll(".legend").data(c).enter().append("g");f.append("circle").attr("r",7).attr("cx",-20).attr("cy",-40).attr("fill",(t=>d(t))),f.append("text").attr("x",-5).attr("y",-37).text((function(t){return t})),f.attr("transform",((t,e)=>"translate("+(n.Smz(c,((t,r)=>r<e?f.nodes()[r].getBBox().width:0))+this.legendOffset+this.legendPadding*e)+",0)")),n.Ys("#"+t+".tooltip").remove();const p=n.Ys("body").append("div").attr("class","tooltip").attr("id",t).style("opacity",0),h=this,v=n.WUZ(this.valueFormat);const m=n.jvg().curve(n.FdL).x((t=>r(this.dateParser(t.key)))).y((t=>l(t.value))),b=s.selectAll("lines").data(this.slices).enter().append("g"),y=b.append("path").attr("fill","none").attr("stroke",(t=>d(t.id))).attr("stroke-width",this.lineWidth).attr("d",(t=>m(t.current)));y.attr("stroke-dashoffset",(function(){return n.Ys(this).node().getTotalLength()})).attr("stroke-dasharray",(function(){return n.Ys(this).node().getTotalLength()})).transition().duration(5e3).ease(n.m2c).attr("stroke-dashoffset",0);const x=b.selectAll("circle").data((t=>t.current.map((e=>(e.color=d(t.id),e.name=t.id,e))))).enter().append("circle");x.attr("stroke",(t=>t.color)).attr("fill","white").attr("stroke-width",this.dotWidth).attr("cy",(t=>l(t.value))).attr("cx",(t=>r(this.dateParser(t.key)))).transition().duration(1500).delay(((t,e)=>100*e+500)).ease(n.m2c).attr("cy",(t=>l(t.value))).attr("cx",(t=>r(this.dateParser(t.key)))).attr("r",this.dotRadius).attr("class","datapoint").attr("id",((t,e)=>e)).style("opacity",1);const k=this.dotRadius;x.on("mouseover",(function(t,e){n.Ys(this).attr("fill",(t=>t.color)).transition().duration(60).attr("r",k+5),function(t,e){p.transition().duration(60).style("opacity",.98),p.html("<b>"+h.intervals[h.selectedInterval].format(h.dateParser(e.key))+"</b><br/>"+v(e.value)).style("left",t.pageX-55+"px").style("top",t.pageY-45+"px")}(t,e)})),x.on("mouseleave",(function(){n.Ys(this).attr("fill","white").transition().duration(60).attr("r",k),p.transition().duration(60).style("opacity",0)}))}}},d=c,f=(0,r(1001).Z)(d,(function(){var t=this,e=t._self._c;return e("VRow",[e("VCol",{attrs:{cols:"12",md:"8","offset-md":"2"}},[e("VRow",{attrs:{dense:""}},[e("VCol",{attrs:{cols:"9"}},[e("p",{staticClass:"text-h6"},[t._v(" "+t._s(t.title)+" ")])]),e("VSpacer"),e("VCol",{staticClass:"text-right",attrs:{cols:"3"}},[0===t.filters.length?e("VSelect",{attrs:{items:t.namesInterval,label:t.$t("Time interval"),dense:""},on:{change:function(e){t.applyFilters(),t.draw()}},model:{value:t.selectedInterval,callback:function(e){t.selectedInterval=e},expression:"selectedInterval"}}):t._e(),t.filters.length>0?e("VDialog",{attrs:{persistent:"","max-width":"300px"},scopedSlots:t._u([{key:"activator",fn:function({on:r,attrs:a}){return[e("VBtn",t._g(t._b({attrs:{color:"primary",dark:"",small:"",fab:""}},"VBtn",a,!1),r),[e("VIcon",{attrs:{small:""}},[t._v(" $vuetify.icons.mdiTuneVariant ")])],1)]}}],null,!1,530295481),model:{value:t.settingDialog,callback:function(e){t.settingDialog=e},expression:"settingDialog"}},[e("VCard",[e("VCardTitle",[e("span",{staticClass:"text-h5"},[t._v(t._s(t.$t("Settings"))+"/"+t._s(t.$t("Filters")))])]),e("VCardText",[e("VContainer",[e("VRow",[e("VCol",{attrs:{cols:"6",sm:"12"}},[e("VSelect",{attrs:{items:t.namesInterval,label:t.$t("Time interval"),dense:""},model:{value:t.selectedInterval,callback:function(e){t.selectedInterval=e},expression:"selectedInterval"}})],1),t._l(t.filters,(function(r){return e("VCol",{key:r.value,attrs:{cols:"6",sm:"12"}},[e("VSelect",{attrs:{items:t.filterItems[r.value]?t.filterItems[r.value]:[],label:r.text,dense:""},model:{value:t.filterModel[r.value],callback:function(e){t.$set(t.filterModel,r.value,e)},expression:"filterModel[filter.value]"}})],1)}))],2)],1)],1),e("VCardActions",[e("VSpacer"),e("VBtn",{directives:[{name:"t",rawName:"v-t",value:"Reset",expression:"'Reset'"}],attrs:{color:"red darken-1",text:""},on:{click:function(e){return t.resetFilters()}}}),e("VBtn",{directives:[{name:"t",rawName:"v-t",value:"Close",expression:"'Close'"}],attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.settingDialog=!1}}}),e("VBtn",{directives:[{name:"t",rawName:"v-t",value:"Save",expression:"'Save'"}],attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.settingDialog=!1,t.applyFilters(),t.draw()}}})],1)],1)],1):t._e()],1)],1),e("ChartViewVRowWebShare",{attrs:{dense:""}},[e("VCol",{attrs:{cols:"12"}},[e("div",{attrs:{id:t.graphId}})])],1)],1)],1)}),[],!1,null,"eb551ed6",null),p=f.exports},18736:function(t,e,r){r.r(e),r.d(e,{default:function(){return f}});var n=r(12555),i=r(4031),l=r(97888),o=r(9934),c={components:{BaseButton:i.Z,BaseButtonDownloadData:l.Z,BaseButtonShare:o.Z},mixins:[(0,n.Z)()]},d=(0,r(1001).Z)(c,(function(){var t=this,e=t._self._c;return e("VRow",t._b({ref:"domToImageNode"},"VRow",t.$attrs,!1),[t._t("default"),e("VCol",{staticClass:"dom-to-image-exclude",attrs:{cols:"12"}},[e("BaseButton",t._b({attrs:{icon:"mdiExport",text:"Export"},on:{click:t.exportImage}},"BaseButton",{progress:t.progress,status:t.status,error:t.error},!1)),e("BaseButtonDownloadData",t._b({},"BaseButtonDownloadData",{disabled:!t.blob,extension:t.extension,filename:t.filename,data:t.blob},!1)),e("BaseButtonShare",t._b({attrs:{"file-share":""}},"BaseButtonShare",{files:t.files,disabled:!t.files},!1))],1)],2)}),[],!1,null,null,null),f=d.exports},60171:function(t,e,r){r.d(e,{XP:function(){return v},b1:function(){return l}});var a="$";function s(){}function n(t,e){var r=new s;if(t instanceof s)t.each((function(t,e){r.set(e,t)}));else if(Array.isArray(t)){var a,n=-1,i=t.length;if(null==e)for(;++n<i;)r.set(n,t[n]);else for(;++n<i;)r.set(e(a=t[n],n,t),a)}else if(t)for(var l in t)r.set(l,t[l]);return r}s.prototype=n.prototype={constructor:s,has:function(t){return a+t in this},get:function(t){return this[a+t]},set:function(t,e){return this[a+t]=e,this},remove:function(t){var e=a+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===a&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===a&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===a&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===a&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===a&&++t;return t},empty:function(){for(var t in this)if(t[0]===a)return!1;return!0},each:function(t){for(var e in this)e[0]===a&&t(this[e],e.slice(1),this)}};var i=n;function l(){var t,e,r,a=[],s=[];function n(r,s,l,o){if(s>=a.length)return null!=t&&r.sort(t),null!=e?e(r):r;for(var u,c,d,f=-1,h=r.length,p=a[s++],v=i(),m=l();++f<h;)(d=v.get(u=p(c=r[f])+""))?d.push(c):v.set(u,[c]);return v.each((function(t,e){o(m,e,n(t,s,l,o))})),m}function l(t,r){if(++r>a.length)return t;var n,i=s[r-1];return null!=e&&r>=a.length?n=t.entries():(n=[],t.each((function(t,e){n.push({key:e,values:l(t,r)})}))),null!=i?n.sort((function(t,e){return i(t.key,e.key)})):n}return r={object:function(t){return n(t,0,o,u)},map:function(t){return n(t,0,c,d)},entries:function(t){return l(n(t,0,c,d),0)},key:function(t){return a.push(t),r},sortKeys:function(t){return s[a.length-1]=t,r},sortValues:function(e){return t=e,r},rollup:function(t){return e=t,r}}}function o(){return{}}function u(t,e,r){t[e]=r}function c(){return i()}function d(t,e,r){t.set(e,r)}function f(){}var h=i.prototype;function v(t){var e=[];for(var r in t)e.push(r);return e}f.prototype=function(t,e){var r=new f;if(t instanceof f)t.each((function(t){r.add(t)}));else if(t){var a=-1,s=t.length;if(null==e)for(;++a<s;)r.add(t[a]);else for(;++a<s;)r.add(e(t[a],a,t))}return r}.prototype={constructor:f,has:h.has,add:function(t){return this[a+(t+="")]=t,this},remove:h.remove,clear:h.clear,values:h.keys,size:h.size,empty:h.empty,each:h.each}},21297:function(t,e,r){r.r(e);var a=r(40290),s=r(18651),n=r(659);const i={props:{values:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[]},messages:{type:Object,default:()=>({})}},data(){return{graphId:"graph_"+this.$store.state.xp.currentTab,totalCount:0,filterCount:0}},mounted(){this.drawViz()},watch:{values(){this.drawViz()}},methods:{drawViz(){},createTextFilterWidget(t,e="Search"){const r=new a.TextFilterWidget(t);return r.placeHolder(this.$tev(e,e)),r}}};e.default=(0,s.Z)(i,n.Z)},19258:function(t,e,r){r.r(e),r.d(e,{addMissingDate:function(){return s}});var a=r(46228);function s(t,e,r,s,n=0,i=null,l=null){if(t.length<=0)return[];const o=a.Wem(t,(t=>new Date(t[e]))),c=s.range(null!==i?s.floor(i):s.floor(o[0]),null!==l?s.ceil(l):s.ceil(o[1]),1).filter((r=>!t.map((t=>t[e])).includes(r.toString())));return c.forEach((a=>{const s={...t[0]};s[e]=a,s[r]=n,t.push(s)})),t}}}]);